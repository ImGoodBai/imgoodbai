<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Goodbai</title>
  
  <subtitle>老白的博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://goodbai.com/"/>
  <updated>2018-03-24T04:57:56.853Z</updated>
  <id>http://goodbai.com/</id>
  
  <author>
    <name>Good Bai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>微信管家源代码分析和文档汇总-持续更新</title>
    <link href="http://goodbai.com/2014/04/21/WXGJCodesAnalytics/"/>
    <id>http://goodbai.com/2014/04/21/WXGJCodesAnalytics/</id>
    <published>2014-04-20T16:00:00.000Z</published>
    <updated>2018-03-24T04:57:56.853Z</updated>
    
    <content type="html"><![CDATA[<p>该套代码在网络上的关键字：微信管家最新官方完整版2014.03.03+官方补丁，有不少淘宝店也在叫卖。<strong>关注微信O2O的创业者、小个体户老板或是其他研究微信公共号营销的同学可以好好研究下。</strong>Goodbai先生欢迎各位在文章后面留言交流。</p><p>##源代码获取、安装<br>本套包含了两套微信源码，一套就是wx目录下面的，另一套就是wx/admin2下面的，两者的关系是，wx目录下的为主体，但有个别模块（如微餐饮/支付管理/微商城等）没有实现，而是直接调用了admin2的实现，事实上admin2目录下本就是另一套的完整功能的代码。  </p><ul><li>下载地址<br>百度云盘下载：<a href="http://pan.baidu.com/s/1kTFjXA3" target="_blank" rel="noopener">http://pan.baidu.com/s/1kTFjXA3</a> 密码：9p4k<br>360云盘下载：<a href="http://yunpan.cn/Q4zhRaTsuuepp" target="_blank" rel="noopener">http://yunpan.cn/Q4zhRaTsuuepp</a>  访问密码 c9c8</li></ul><p>下面介绍LINUX系统下的安装。  </p><h3 id="第一步-准备环境"><a href="#第一步-准备环境" class="headerlink" title="第一步 准备环境"></a>第一步 准备环境</h3><ol><li>Linux安装http服务器+php+mysql环境，建议选择centOS+apache+php+mysql方案，具体方法请自行google;  </li><li>配置默认mysql数据库root用户密码，安装phpmyadmin管理工具;  </li><li>开启http伪静态支持。  </li></ol><h3 id="第二步-安装配置"><a href="#第二步-安装配置" class="headerlink" title="第二步 安装配置"></a>第二步 安装配置</h3><ol><li>上传<br>首先把根目录下的 WX 及 YYUC上传至网站跟目录 </li><li>还原数据库<br>将目录内的weixin.sql数据库文件还原至服务器建议使用phpmyadmin导入站点架设</li><li>以上步骤完成后，开始绑定域名，<br>只需将域名绑定到 WX目录下的public_html目录即可（也可直接把http服务器的root设置到public_html）。</li><li>配置文件<br>打开wx目录下的 conf.php 文件  并修改配置<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/*数据库地址~*/</span><br><span class="line">public static $db_host = &quot;localhost&quot;;  </span><br><span class="line">/*数据库端口~*/</span><br><span class="line">public static $db_port = &quot;3306&quot;; 不用修改</span><br><span class="line">/*数据库名~*/</span><br><span class="line">public static $db_dbname = &quot;weixin&quot;;</span><br><span class="line">/*数据库用户名~*/</span><br><span class="line">public static $db_username = &quot;root&quot;; 填写你的数据库账号</span><br><span class="line">/*数据库密码~*/</span><br><span class="line">public static $db_password = &quot;xxxxxx&quot;; 填写你的数据库密码</span><br></pre></td></tr></table></figure></li></ol><p>完成上述操作第一步安装完成，输入ip或者域名，应该就可以看到首页。</p><h3 id="第三步-配置第二套源码"><a href="#第三步-配置第二套源码" class="headerlink" title="第三步 配置第二套源码"></a>第三步 配置第二套源码</h3><p>配置第二套源码（即wx/public_html/admin2)。  </p><ul><li>配置数据库信息<br>打开wx\pub\admin2\Conf 下的 db.php，修改数据库用户名和密码信息，如下：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DB_HOST    对应  localhost</span><br><span class="line">DB_NAME    对应 weixin</span><br><span class="line">DB_USER    对应  数据用户名</span><br><span class="line">DB_PWD    对应  数据库密码</span><br></pre></td></tr></table></figure><p>到这里安装完成，如果人品不差，通过首页进去看到的各项功能应该大多数可以正常使用。</p><p>##代码结构分析及优化<br>本套代码近700多M，代码结构是什么样？有没有隐藏的后门呢？代码是否可以精简？下面简单梳理一下。  </p><p>源代码解开后根目录结构如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ tree  -L 2 src</span><br><span class="line">src</span><br><span class="line">├── weixin.sql       #数据库文件</span><br><span class="line">├── wx               #主程序目录</span><br><span class="line">│   ├── conf.php     #数据库配置文件</span><br><span class="line">│   ├── controller   #controler目录</span><br><span class="line">│   ├── fun          #函数库</span><br><span class="line">│   ├── i18n         #国际化</span><br><span class="line">│   ├── log          #调试模式下的日志输出目录</span><br><span class="line">│   ├── model        </span><br><span class="line">│   ├── plugin     </span><br><span class="line">│   ├── public_html  #web访问入口，也是网站根目录</span><br><span class="line">│   ├── pubupload</span><br><span class="line">│   ├── sys          #cache和预编译后的视图文件目录         </span><br><span class="line">│   └── view         #视图文件</span><br><span class="line">├── yyuc             #yyuc开发框架</span><br><span class="line">│   ├── controller</span><br><span class="line">│   ├── forders</span><br><span class="line">│   ├── plugin</span><br><span class="line">│   ├── sys</span><br><span class="line">│   └── yyuc.php</span><br><span class="line">└── 安装说明.txt</span><br></pre></td></tr></table></figure></p><p>本套代码基于yyuc框架开发，采用MVC开发模式，wx/controller存放控制器文件，wx/view/存放视图文件，在非开发模式下wx/sys/compilations目录存放预编译后（参考最后附录的yyuc开发框架说明文档）的视图文件，知道这个整个代码的结构就清晰了，每一个页面的可视html代码去wx/view(非开发模式时为wx/sys/compilations）找，页面业务逻辑去wx/controller找。</p><p>wx/public_html/目录作为全站根目录，其内部结构介绍如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ tree  -L 1 wx/public_html/</span><br><span class="line">wx/public_html/</span><br><span class="line">├── admin2       #另一套代码，被间接调用          </span><br><span class="line">├── bind </span><br><span class="line">├── bst.html</span><br><span class="line">├── cache</span><br><span class="line">├── css</span><br><span class="line">├── heka</span><br><span class="line">├── index.php   #全站入口页面</span><br><span class="line">├── js          </span><br><span class="line">├── media</span><br><span class="line">├── public_html</span><br><span class="line">├── res</span><br><span class="line">├── static       #PC web首页目录，有三套模板，对应wxgjcom/wxgjcn/wxxxxx</span><br><span class="line">├── Swipe-master</span><br><span class="line">├── @system</span><br><span class="line">├── upload</span><br><span class="line">├── uploadify</span><br><span class="line">├── ups</span><br><span class="line">├── wqc        #后台用户上传资源存放目录</span><br><span class="line">├── wxapi.php</span><br><span class="line">└── zwj</span><br></pre></td></tr></table></figure></p><p>所有页面相关的资源文件（js/css/image等）都在该目录下，包括用户图片上传目录。</p><h3 id="明显需要修改的"><a href="#明显需要修改的" class="headerlink" title="明显需要修改的"></a>明显需要修改的</h3><ol><li>许多地方写死域名（<a href="http://www.weixinguanjia.com/），需要批量替换" target="_blank" rel="noopener">www.weixinguanjia.com/），需要批量替换</a>;</li><li>部分wap页面包含有站长站统计代码（cnzz.com），需要批量替换;</li></ol><h2 id="常见问题列表"><a href="#常见问题列表" class="headerlink" title="常见问题列表"></a>常见问题列表</h2><ol><li>问题：访问注册页面（也就是reg.html）时，提示找不到reg.html文件？<br>答：需要开启web服务器的伪静态支持。  </li><li>问题：后台管理入口在哪里？<br>答：后台地址：你的网址/houtai  默认帐户(admin  123456789)  </li><li>问题：管理员数据库表是哪个？<br>答：管理员账号密码请到数据库weixin里面查看数据库表user_agency   </li><li>无法上传文件（图片）？<br>答：文件夹权限不正确，解决：chmod o+w upload -R  chmod o+w ups/ -R (解决微首页图片上传不成功）  </li><li>如何更换默认首页？<br>答： 安装完成后默认首页是旧版，切换成新版请修改wx/controller/index.php  里面最后几行的网址为你的网址即可</li><li>部分页面有乱码如何解决？<br>答：可能是数据库导入编码有误，建议使用phpmyadmin工具导入，步骤为使用phpmyadmin新建weixin数据库，再调整数据库编码为utf8-general-ci（否则会出现中文乱码），再移动weixin.sql到/var/lib/phpMyAdmin/upload/后，通过phpmyadmin导入功能导入数据。</li></ol><p>##参考资料</p><ol><li>YYUC与PHP开发框架比较（wang_quan_li）：<br><a href="http://blog.csdn.net/wang_quan_li/article/details/21049125" target="_blank" rel="noopener">http://blog.csdn.net/wang_quan_li/article/details/21049125</a>  </li><li>微信第三方服务平台源码分析——每个Action与模块的对应关系：<br><a href="http://blog.csdn.net/wang_quan_li/article/details/20958001" target="_blank" rel="noopener">http://blog.csdn.net/wang_quan_li/article/details/20958001</a>  </li><li>YYUC文档资料：<br><a href="http://pan.baidu.com/s/1jGqPWWY#dir/path=%2F%E5%BE%AE%E4%BF%A1%2F%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E8%B5%84%E6%96%99" target="_blank" rel="noopener">http://pan.baidu.com/s/1jGqPWWY#dir/path=%2F%E5%BE%AE%E4%BF%A1%2F%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E8%B5%84%E6%96%99</a>  </li><li>安装参考1：<br><a href="http://www.y154.com/source-code/website-source/374.html" target="_blank" rel="noopener">http://www.y154.com/source-code/website-source/374.html</a>（publick_html &gt;pub)  </li></ol>]]></content>
    
    <summary type="html">
    
      这套微信营销系统代码500M多，功能比较完整，包括PC端web站、后台代理/用户分级管理系统和用户微信公共号后台功能定制系统三部分，但整个代码感觉是很多地方拼凑而来，实现粗放，有不少地方需要完善，但相对于不劳而获，已经算是很不错的东西。
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="微信公众号" scheme="http://goodbai.com/tags/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
      <category term="源码分析" scheme="http://goodbai.com/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>阿里云个人网站备案过程全记录</title>
    <link href="http://goodbai.com/2014/04/10/HowToICP/"/>
    <id>http://goodbai.com/2014/04/10/HowToICP/</id>
    <published>2014-04-09T16:00:00.000Z</published>
    <updated>2018-03-24T04:50:31.887Z</updated>
    
    <content type="html"><![CDATA[<p>入了Linode东京机房的VPS，国内ping值竟达到500ms（说是“携程信用卡事件”导致怎么的），可过了两天未见好转。加上SHLUG H4活动上@tinyfool 同学说备案一周可完成，果断要求Linode退了款，加入阿里云开始走ICP备案流程。</p><p>##介绍</p><p><strong>什么是ICP备案？</strong></p><p>照例先码概念，什么是ICP备案，<strong>ICP备案</strong>（又叫网站备案、域名备案等）参考百度<a href="http://baike.baidu.com/view/67420.htm" target="_blank" rel="noopener">ICP备案</a>词条。《互联网信息服务管理办法》规定对<strong>非经营性互联网信息服务</strong>（对应经营性互联网信息服务商另有制度管理，一般试用盈利性质的企业））实行<strong>报备登记</strong>制度。</p><p><strong>ICP备案的含义？</strong></p><p>ICP备案的含义是主机、站长（个人或者法人）、域名和网站经营内容四者的一个绑定认证关系，啥意思呢？就是互联网不是法外之地，如果备案域名指向的这块地（主机）上，以后如果出了啥“漏子”，就拿经过实名认证的站长同学试问。</p><p>反过来如果那个域名没有经备案主机提供商（如阿里云之类）就给予了接入权限，那一旦该域名指向的网站出了问题，当局是要拿主机提供商问罪的，所以国内一般大的主机提供商都要求入住的网站先备案再解析，这也是政策规定（当然也有一些小公司打打擦别球，不严格执行）。</p><p><strong>几个细节说明</strong></p><ol><li>仅针对互联网信息服务实行备案制度，即通过80端口访问的http服务（通俗讲就是可通过浏览器访问到），而ftp/ssh等服务并不在此列（个人亲测阿里云亲测通过）;</li><li>仅针对通过域名访问的情况，即如果你是通过ip地址直接访问你的网站，则不需要备案;</li><li>如果你的主机不在神州大地（在境内），则不需要备案，因为该行为最终是由主机商执行，而境外直接无视该规定。</li></ol><p><strong>ICP备案的建议</strong></p><p>下面情况建议直接选择国外主机商（如linode VPS之类），好处是省事，坏处是近来国外的主机抽风越來越严重（可能与GFW有染），访问延迟大。    </p><ol><li>嫌ICP备案太麻烦，不愿意折腾;</li><li>网站内容见不得阳光;</li></ol><p>其他情况推荐尝试选用国内主机+ICP备案方案，整个流程比较复杂，但还算顺利，是个人网站备案，一个流程下来到最终核准共2周时间。</p><p>下面内容记录了个人类域名在阿里云托管首次办理ICP备案过程，本例注册地为江苏苏州，不同地区过程可能有差异（如部分地区可能需要在文件上按手印，阿里云备案系统有提示）。  </p><p>##总体流程</p><p>阿里云首次备案指南：<a href="http://help.aliyun.com/view/13445871.html" target="_blank" rel="noopener">http://help.aliyun.com/view/13445871.html</a><br>阿里云备案管理系统入口：<a href="http://aliyun.gein.cn/webbaaliyun/login.action" target="_blank" rel="noopener">http://aliyun.gein.cn/webbaaliyun/login.action</a>  </p><p>阿里云官方指南非常详细，下图出自<a href="http://help.aliyun.com/view/13445871.html" target="_blank" rel="noopener">阿里云首次备案指南</a><br><img src="http://gtms03.alicdn.com/tps/i3/T1ZKqRFDteXXbW6QIE-541-903.jpg" alt="阿里云ICP备案流程"></p><h2 id="第一步-申请备案服务号"><a href="#第一步-申请备案服务号" class="headerlink" title="第一步 申请备案服务号"></a>第一步 申请备案服务号</h2><p>申请备案服务号前提条件：  </p><ol><li>已经购买一台云服务器主机（即VPS）;  </li><li>为VPS绑定了一个公网IP;  </li></ol><p>满足如上后开始申请备案服务号，进入阿里云控制台&gt;点击用户名中的”用户中心”&gt;备案管理（或者直接进入<a href="http://bsn.aliyun.com/" target="_blank" rel="noopener">备案管理</a>，该步完成。</p><h2 id="第二步-提交备案信息初审"><a href="#第二步-提交备案信息初审" class="headerlink" title="第二步 提交备案信息初审"></a>第二步 提交备案信息初审</h2><p>登陆<a href="http://aliyun.gein.cn/" target="_blank" rel="noopener">阿里云ICP代备案管理系统</a> （<strong>注意，代办系统独立于阿里云系统，需要重新申请帐号</strong>），填写备案信息，内容包括三方面：</p><ul><li>主体信息，即单位或个人名字，证件编号，地址之类;  </li><li>网站信息，网站经营内容，行业分类等（该部分要注意内容）;  </li><li>上传资料，包括身份证正反复印件、网站备案信息真实性核验单扫描件（<a href="http://aliyun.gein.cn/webbaaliyun/images/pics/upload_source15.jpg" target="_blank" rel="noopener">参考</a>）和信息安全管理协议扫描件（<a href="http://aliyun.gein.cn/webbaaliyun/images/pics/upload_source19_bj.jpg" target="_blank" rel="noopener">参考</a>）。  </li></ul><p>如上提交完成后，等待阿里将在一个工作日完成初审，<strong>注意，上述两份手写签名后的材料一定要留底，不能扔掉</strong>。</p><h2 id="第三步-邮寄资料"><a href="#第三步-邮寄资料" class="headerlink" title="第三步 邮寄资料"></a>第三步 邮寄资料</h2><p>邮寄内容：  </p><blockquote><p>网站备案信息真实性核验单     原件一式三份<br>信息安全管理协议      原件一式三份  </p></blockquote><p>邮寄地址：  </p><blockquote><p>河南省洛阳市洛龙区太康路东段洛阳信息通信产业园顺兴园区9号楼4楼<br>收件人： 信息认证事业部 联系电话：15139943094<br>邮 编：471000</p></blockquote><h2 id="第四步-办理拍照"><a href="#第四步-办理拍照" class="headerlink" title="第四步 办理拍照"></a>第四步 办理拍照</h2><p>拍照需要专用幕布，有两种办法操作。<br>方法1：  </p><blockquote><p>前往拍照核验点免费办理拍照 （推荐！无需等待，当天即可办完）<br>请 XXX 本人携带以下资料前往核验点：<br>1、XXX 的身份证原件；<br>2、记录备案订单号：232200XXXXX；<br>拍照核验点工作时间： 自然日9:00-18:00（请提前电话联系） 查看您所在区域核验点地址   </p></blockquote><p>方法2：</p><blockquote><p> 申请邮寄幕布 您自行拍照后上传 ◆◆* 需等待幕布邮寄，约2-3个工作日<br>第1步、您已经申请过背景幕布<br>第2步、收到幕布后按《拍照说明》拍摄 XXX 本人照片,点击查看拍照说明<br>第3步、将拍好的幕布背景照片上传至系统  上传 XXX 照片  </p><ul><li>我们为您邮寄了2份背景幕布，分别是：“万网背景幕布”和“阿里云背景幕布”；<br>请您在收到幕布后，分别拍摄“万网幕布背景照片”和“阿里云幕布背景照片“。  </li><li>幕布免费寄给您，拍照后幕布无需寄回，您可留下反复使用。  </li></ul></blockquote><p>完成拍照后上传照片，照片要求分辨率800x600。我申请寄送幕布服务，幕布当天由北京经顺丰快递发出（第二天就收到），运费也是阿里方承担，且幕布也不需要寄回，这个要赞一下阿里（其实是万网）的服务，以后在上海有人ICP备案可以直接找我。</p><h2 id="提交管局审核"><a href="#提交管局审核" class="headerlink" title="提交管局审核"></a>提交管局审核</h2><p>第三步和第四步完成，阿里云核对无误后将提交进入管局审核阶段，如下。</p><blockquote><p>您的照片和资料已经审核通过，阿里云 将在1<strong>个工作日</strong>内将您的备案信息提交至省通信管理局审核。</p></blockquote><p>接下来  </p><blockquote><p>阿里云 已经将您的备案信息提交至省通信管理局审核。<br>通信管理局正常审核时间为<strong>20个工作日</strong>内，请您耐心等候，备案成功后您将收到来自工信部的短信、邮件通知。 部分省通信管理局在备案审核过程中，可能会拨打您的电话进行核查，请保持<strong>您的座机和手机畅通</strong>并配合管局的核查。</p></blockquote><h2 id="审核通过"><a href="#审核通过" class="headerlink" title="审核通过"></a>审核通过</h2><p>提交管局后大概一周内收到了审核通过的短信通知。现在可以放心绑定域名到ip开始使用了。</p><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><ul><li>提交备案申请后，需要停止该域名的解析（包括<a href="http://www.xxx子域名），否则阿里初审就会打回" target="_blank" rel="noopener">www.xxx子域名），否则阿里初审就会打回</a>;  </li><li>域名提交后大概在一个工作日内即完成初审;  </li><li>邮寄资料和拍照可同时进行（邮寄时走快递，到洛阳估计的一两天，而拍照是通过网络提交）;</li><li>联系人手机号码归属地和申请备案本地要一致</li></ul>]]></content>
    
    <summary type="html">
    
      万恶的ICP备案制度应该唾骂，主机架国外可以省去备案，但越來越恶劣的网络出口环境，实在无法接受...操作下来阿里云的个人代备案系统搞得还行。
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="ICP备案" scheme="http://goodbai.com/tags/ICP%E5%A4%87%E6%A1%88/"/>
    
  </entry>
  
  <entry>
    <title>为什么COS一出世逼格就这么高？</title>
    <link href="http://goodbai.com/2014/02/13/WhyCOS_SoHot/"/>
    <id>http://goodbai.com/2014/02/13/WhyCOS_SoHot/</id>
    <published>2014-02-12T16:00:00.000Z</published>
    <updated>2018-03-24T04:57:16.566Z</updated>
    
    <content type="html"><![CDATA[<p>刚过完2013年春节，国内操作系统领域便发生一件大事，1月15日中国科学院软件研究院和上海联彤网络通讯技术有限公司（以下简称上海联彤）在京<a href="http://tech.sina.com.cn/t/2014-01-16/11239101963.shtml" target="_blank" rel="noopener">联合发布了被称为具有自主知识产权的国产操作系统COS</a>(China Operating System)，消息一出便在网络上引起了极大关注，有质疑的，有受鼓舞的。  </p><p>分析一件事情必须要紧密结合事件背后的大环境，脱离了大环境怎么可能得出让人信服的结论。下面我们就来八一八COS事件背后的故事，读完这个故事就一切水落石出。</p><p>##与COS有关的公司<br>先来看下面几家公司的资料：    </p><ul><li><p><a href="http://www.viatech.com.cn/cn/company/locations.jsp" target="_blank" rel="noopener">VIA(威盛)</a><br>董事长：<strong>王雪红</strong><br>介绍：威盛电子是全球仅有的三家可以做X86架构CPU的公司之一（另外两家是Intel和AMD）。详细参考<a href="http://zh.wikipedia.org/wiki/%E5%A8%81%E7%9B%9B%E9%9B%BB%E5%AD%90" target="_blank" rel="noopener">维基百科</a></p></li><li><p><a href="http://www.htc.com/cn/about/leadership/" target="_blank" rel="noopener">HTC</a><br>董事长：<strong>王雪红</strong><br>地址：上海市浦东新区博霞路11号</p></li><li><p>上海联彤<br>没有官方网站。<br>投资方：联彤的控股股东，是上海联和投资有限公司（也有叫上海联合投资有限公司）。  </p></li><li><p>兆芯<br>全称<a href="http://campus.chinahr.com/2014/pages/via_vas/" target="_blank" rel="noopener">上海兆芯集成电路有限公司</a><br>投资方：兆芯集成电路是<strong>威盛集团</strong>和<strong>上海联和投资</strong>共同出资成立的一个新公司。<br>董事长：<strong>江绵恒</strong><br>介绍：专注于研发X86、ARM SOC、3D图形以及高速外设等芯片产品。目前公司产品覆盖CPU、芯片组、手机SOC，机顶盒SOC等各个领域 </p></li><li><p><a href="http://www.china-cos.com/about/index.html" target="_blank" rel="noopener">COS</a>(China Operating System，简称COS)<br>投资方：<strong>中国科学院软件研究所</strong>与<strong>上海联彤网络通讯技术有限公司</strong>联合推出。<br>介绍：COS是一种开源的操作系统，可广泛应用于个人电脑、智能掌上终端、机顶盒、智能家电等领域。<br>地址：上海市浦东新区博霞路11号</p></li></ul><p>上面介绍中出现两个关键人物：  </p><ul><li><a href="http://zh.wikipedia.org/wiki/%E7%8E%8B%E9%9B%AA%E7%B4%85" target="_blank" rel="noopener"><strong>王雪红</strong></a>，台湾前富豪王永庆之女，HTC和VIA的董事长;  </li><li><a href="http://zh.wikipedia.org/wiki/%E6%B1%9F%E7%BB%B5%E6%81%92" target="_blank" rel="noopener"><strong>江绵恒</strong></a>，现任中国科学院副院长、中科院上海分院院长（<a href="http://www.shb.cas.cn/fygk/xrld/" target="_blank" rel="noopener">参考</a>），<a href="http://www.baike.com/wiki/%E4%B8%8A%E6%B5%B7%E8%81%94%E5%90%88%E6%8A%95%E8%B5%84%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8" target="_blank" rel="noopener">上海联和投资</a>董事长。</li></ul><p>根据上面的材料，隐隐可以推测出这样的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COS = 中科院 + HTC  </span><br><span class="line">兆芯 = 中科院 + VIA</span><br></pre></td></tr></table></figure></p><p>而<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COS + 兆芯 = 国产基础软硬件</span><br></pre></td></tr></table></figure></p><p><strong>台湾人王雪红为什么突然开始染指大陆“国产基础软硬件”事业呢？</strong>到这里你可能有点看不懂，没有关系，我们继续分析。</p><p>##大背景</p><p>2008年10月21日起，微软公司对盗版Windows和Office用户进行“<a href="http://www.baike.com/wiki/%E5%BE%AE%E8%BD%AF%E9%BB%91%E5%B1%8F&amp;prd=button_doc_jinru" target="_blank" rel="noopener">黑屏事件</a>”警告性提示。该事件直接导致中国政府支持的预计总投入将超过1000亿元的”<a href="http://baike.baidu.com/view/2103756.htm" target="_blank" rel="noopener">核高基</a>“重大专项上马，从此中国浩浩荡荡的“软硬件国产化”全面拉开序幕。</p><p>于是乎各企业单位都行动起来了，详情参见：<a href="http://tech.sina.com.cn/it/2011-04-02/14275364960.shtml" target="_blank" rel="noopener">http://tech.sina.com.cn/it/2011-04-02/14275364960.shtml</a></p><blockquote><p>国产关键基础软硬件技术联盟是在核高基重大专项、863计划、电子信息产业发展基金、知识创新工程的支持下，由北京龙芯中科技术服务中心有限公司、中电科技(北京)有限公司、中标软件有限公司和湖南麒麟信息工程技术有限公司4家企业发起成立，以后将逐步吸纳其它从事国产化软硬件系统开发、研制、生产的企业加入。</p><p>国产关键基础软硬件技术联盟致力于解决和突破国产处理器/芯片组、固件、操作系统配套使用时的适配和应用技术，满足国家重点行业的应用系统对国产基础软件硬件技术的要求，实现成员间各组件的紧密支撑。</p></blockquote><p>注意看这里面好像没有中科院什么事，中科红旗（隶属于中科院旗下）Linux可是国内名气第一的Linux品牌。    </p><p>而2013年的<a href="http://zh.wikipedia.org/wiki/%E7%88%B1%E5%BE%B7%E5%8D%8E%C2%B7%E6%96%AF%E8%AF%BA%E7%99%BB" target="_blank" rel="noopener">斯诺登事件</a>更坚定了领导者的决心。</p><p>大背景就是中国政府要打造”自主可控的软硬件体系”，以应对日益严峻的信息安全问题。</p><p><strong>CEC</strong>  </p><p><strong>CETC</strong>  </p><p><strong>国防科大</strong>  </p><p><strong>龙芯</strong>  </p><p><strong>今天先写到这里，本文涉及面比较广，梳理梳理再开始。</strong></p><p>##参考<br>综合类#威盛.兆芯招聘–师兄来爆料：<a href="http://club.xdnice.com/thread-1321793-1-1.html" target="_blank" rel="noopener">http://club.xdnice.com/thread-1321793-1-1.html</a><br>中国自主知识产权手机操作系统靠谱？扒个皮先！：<a href="http://www.huxiu.com/article/26601/1.html" target="_blank" rel="noopener">http://www.huxiu.com/article/26601/1.html</a><br>国产COS系统的真相：中科院、HTC、上海联彤意欲何为？：<a href="http://news.hiapk.com/20140207/1484736_2.html" target="_blank" rel="noopener">http://news.hiapk.com/20140207/1484736_2.html</a><br>漫谈上海联彤与中科院软件所COS操作系统与有线背景分析：<a href="http://bbs.dvbcn.com/showtopic-643513-1.html" target="_blank" rel="noopener">http://bbs.dvbcn.com/showtopic-643513-1.html</a>  </p>]]></content>
    
    <summary type="html">
    
      国内高科技领域“放卫星”的传统历来有之，COS这次如此高调，中科院为后台，钓鱼台国宾馆开发布会。到底什么来头，会如何发展，是否对国内现有的操作系统市场格局产生重大冲击，抑或只是昙花一现，欲知详情，请看正文。
    
    </summary>
    
      <category term="event" scheme="http://goodbai.com/categories/event/"/>
    
    
      <category term="Linux" scheme="http://goodbai.com/tags/Linux/"/>
    
      <category term="国产基础软件" scheme="http://goodbai.com/tags/%E5%9B%BD%E4%BA%A7%E5%9F%BA%E7%A1%80%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>可用的图片搜索（包括以图搜图）Web API全解析</title>
    <link href="http://goodbai.com/2014/02/12/ImageSearchAPI/"/>
    <id>http://goodbai.com/2014/02/12/ImageSearchAPI/</id>
    <published>2014-02-11T16:00:00.000Z</published>
    <updated>2018-03-24T04:56:52.832Z</updated>
    
    <content type="html"><![CDATA[<p>一般所指的图片搜索是通过关键字来搜索主题相关的图片，如搜索<a href="http://image.baidu.com/i?tn=baiduimage&amp;ipn=r&amp;ct=201326592&amp;cl=2&amp;lm=-1&amp;st=-1&amp;fm=result&amp;fr=&amp;sf=1&amp;fmq=1392186127987_R&amp;pv=&amp;ic=0&amp;nc=1&amp;z=&amp;se=1&amp;showtab=0&amp;fb=0&amp;width=&amp;height=&amp;face=0&amp;istype=2&amp;ie=utf-8&amp;word=%E7%BE%8E%E5%A5%B3" target="_blank" rel="noopener">MM</a>;以图搜图则是指通过手头已有的图片来搜索与之相似或者相同的图片，你可能有<a href="http://img.67.com/thumbs/upload/images/2013/09/11/eGlvbmdoYW5saW4xMzc4ODg5ODU5_7_h150_t.jpg" target="_blank" rel="noopener">这一张图片</a>，不知道图片上的人是谁，你可以试试百度以图搜图<a href="http://image.baidu.com/i?ct=3&amp;tn=shituresult&amp;pn=0&amp;rn=10&amp;querysign=762438889,4149743864&amp;q_txt=&amp;rainbow=1&amp;keyword=%E8%8B%8D%E4%BA%95%E7%A9%BA&amp;shituRetNum=173&amp;similarRetNum=600&amp;faceRetNum=0&amp;setnum=0&amp;beautynum=0&amp;imgurl=http://tutu1.baidu.com/1003/similar/20140212/18/762438889,4149743864.jpg" target="_blank" rel="noopener">搜一下</a>，该图片信息以及相关信息便一目了然。</p><p>本文包括三部分内容：</p><ol><li>以图搜图API分析 </li><li>图片识别和图片处理API分析;</li><li>通过关键字搜索相关图片API分析。</li></ol><h2 id="以图搜图-API"><a href="#以图搜图-API" class="headerlink" title="以图搜图 API"></a>以图搜图 API</h2><p>以图搜图有下面几项用途：</p><ol><li>发现图片的来源与相关信息；</li><li>研究追踪图片信息在互联网的传播；</li><li>找到高分辨率版本的图片；</li><li>找到有你照片的网页；</li><li>看看这张图片有哪些不同版本。</li></ol><p>三个主流以图搜图引擎如下：</p><ol><li><a href="http://images.google.com.hk/imghp?hl=zh-CN" target="_blank" rel="noopener">Google搜图</a>;</li><li><a href="http://stu.baidu.com/" target="_blank" rel="noopener">Baidu识图</a>;</li><li><a href="http://tineye.com/" target="_blank" rel="noopener">TinEye</a>，对国内图片收录不理想。</li></ol><p>Google较保守，没有API可用;TinEye效果不理想；下面重点分析百度搜图API。  </p><p>虽然Baidu没有公开其搜图API，但经过潜心挖掘，API其实是可用的，而且还支持JSON数据格式，如下：  </p><p><strong>API形式1(参数tn可选faceresult/facejson)：</strong><br><a href="http://stu.baidu.com/i?objurl=http%3A%2F%2Fimages.enet.com.cn%2F2008%2F1225%2F96%2F1995683.jpg&amp;filename=&amp;rt=0&amp;rn=10&amp;ftn=searchstu&amp;ct=1&amp;stt=1&amp;tn=faceresult" target="_blank" rel="noopener">http://stu.baidu.com/i?objurl=http%3A%2F%2Fimages.enet.com.cn%2F2008%2F1225%2F96%2F1995683.jpg&amp;filename=&amp;rt=0&amp;rn=10&amp;ftn=searchstu&amp;ct=1&amp;stt=1&amp;tn=faceresult</a><br><strong>API形式2 (参数tn可选shituresult/facejson）：</strong><br><a href="http://stu.baidu.com/i?ct=3&amp;tn=shituresult&amp;pn=0&amp;rn=10&amp;querysign=3046724883,3054654929&amp;shituRetNum=8&amp;similarRetNum=600&amp;faceRetNum=1000&amp;setnum=0&amp;beautynum=0" target="_blank" rel="noopener">http://stu.baidu.com/i?ct=3&amp;tn=shituresult&amp;pn=0&amp;rn=10&amp;querysign=3046724883,3054654929&amp;shituRetNum=8&amp;similarRetNum=600&amp;faceRetNum=1000&amp;setnum=0&amp;beautynum=0</a><br><strong>API形式3：</strong><br><a href="http://stu.baidu.com/i?ct=3&amp;tn=facejson&amp;rn=6&amp;querysign=3544027739,3922013179&amp;shituRetNum=8&amp;similarRetNum=20&amp;faceRetNum=10&amp;setnum=0&amp;beautynum=0&amp;stt=1&amp;size_filter=-1&amp;tab=0&amp;pn=0&amp;date_filter=0&amp;width=&amp;height=&amp;ic=0&amp;z=&amp;sign=3046724883,3054654929" target="_blank" rel="noopener">http://stu.baidu.com/i?ct=3&amp;tn=facejson&amp;rn=6&amp;querysign=3544027739,3922013179&amp;shituRetNum=8&amp;similarRetNum=20&amp;faceRetNum=10&amp;setnum=0&amp;beautynum=0&amp;stt=1&amp;size_filter=-1&amp;tab=0&amp;pn=0&amp;date_filter=0&amp;width=&amp;height=&amp;ic=0&amp;z=&amp;sign=3046724883,3054654929</a>  </p><p>对形式1 API分析示例如下：<a href="http://stu.baidu.com/i?objurl=http%3A%2F%2Fimages.enet.com.cn%2F2008%2F1225%2F96%2F1995683.jpg&amp;filename=&amp;rt=0&amp;rn=10&amp;ftn=searchstu&amp;ct=1&amp;stt=1&amp;tn=facejson" target="_blank" rel="noopener">http://stu.baidu.com/i?objurl=http%3A%2F%2Fimages.enet.com.cn%2F2008%2F1225%2F96%2F1995683.jpg&amp;filename=&amp;rt=0&amp;rn=10&amp;ftn=searchstu&amp;ct=1&amp;stt=1&amp;tn=facejson</a><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        <span class="attr">"imgName"</span>:<span class="string">" "</span>,</span><br><span class="line">        <span class="attr">"imgQuerySign"</span>:<span class="string">"1478561841,3033972892"</span>,</span><br><span class="line">        <span class="attr">"displayNum"</span>:<span class="number">1000</span>,</span><br><span class="line">        <span class="attr">"listNum"</span>:<span class="number">1000</span>,</span><br><span class="line">        <span class="attr">"rank"</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="attr">"beforeCt"</span>:<span class="number">3</span>,</span><br><span class="line">        <span class="attr">"keyword"</span>:<span class="string">""</span>,</span><br><span class="line">        <span class="attr">"data"</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"thumbURL"</span>:<span class="string">"http://t2.baidu.com/it/u=2299942138,954331452&amp;fm=62&amp;gp=0.jpg"</span>,</span><br><span class="line">                <span class="attr">"middleURL"</span>:<span class="string">"http://t2.baidu.com/it/u=2299942138,954331452&amp;fm=62&amp;gp=0.jpg"</span>,</span><br><span class="line">                <span class="attr">"largeTnImageUrl"</span>:<span class="string">"http://t2.baidu.com/it/u=2299942138,954331452&amp;fm=62&amp;gp=0.jpg"</span>,</span><br><span class="line">                <span class="attr">"hoverURL"</span>:<span class="string">"http://t2.baidu.com/it/u=2299942138,954331452&amp;fm=62&amp;gp=0.jpg"</span>,</span><br><span class="line">                <span class="attr">"faceURL"</span>:<span class="string">"http://t2.baidu.com/it/u=2792293033,3107780835&amp;fm=61&amp;gp=0.jpg"</span>,</span><br><span class="line">                <span class="attr">"hasLarge"</span>:<span class="number">0</span>,</span><br><span class="line">                <span class="attr">"simi"</span>:<span class="string">"99"</span>,</span><br><span class="line">                <span class="attr">"objURLKey"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"pageNum"</span>:<span class="number">0</span>,</span><br><span class="line">                <span class="attr">"objURL"</span>:<span class="string">"http://img3.douban.com/view/photo/photo/public/p1221998136.jpg"</span>,</span><br><span class="line">                <span class="attr">"fromURL"</span>:<span class="string">"http://movie.douban.com/photos/photo/1221998136/"</span>,</span><br><span class="line">                <span class="attr">"fromURLEnc"</span>:<span class="string">"http://movie.douban.com/photos/photo/1221998136/"</span>,</span><br><span class="line">                <span class="attr">"fromURLHost"</span>:<span class="string">"http://movie.douban.com"</span>,</span><br><span class="line">                <span class="attr">"width"</span>:<span class="number">449</span>,</span><br><span class="line">                <span class="attr">"height"</span>:<span class="number">600</span>,</span><br><span class="line">                <span class="attr">"objId"</span>:<span class="number">255534948</span>,</span><br><span class="line">                <span class="attr">"objType"</span>:<span class="string">"jpg"</span>,</span><br><span class="line">                <span class="attr">"time"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"fileSize"</span>:<span class="string">"52"</span>,</span><br><span class="line">                <span class="attr">"fromPageTitle"</span>:</span><br><span class="line">                <span class="string">"替身姐妹 第一季 剧照 "</span>,</span><br><span class="line">                <span class="attr">"fromPageTitleEnc"</span>:<span class="string">"替身姐妹 第一季 剧照 "</span>,</span><br><span class="line">                <span class="attr">"textHost"</span>:<span class="string">"替身姐妹 第一季的剧照 "</span></span><br><span class="line">        &#125;,</span><br><span class="line">        ......</span><br><span class="line"></span><br><span class="line">        &#123;&#125;</span><br><span class="line">        ]</span><br><span class="line">&#125;</span><br><span class="line">~</span><br></pre></td></tr></table></figure></p><p>##图片识别和图片处理API</p><p>###faceplusplus<br><a href="http://www.faceplusplus.com.cn/" target="_blank" rel="noopener">faceplusplus</a>是北京一家专门做人脸处理技术的公司，被创新工厂投资，faceplusplus格式化人脸数据内容较丰富，提供的API也比较多，具体可以参考其<a href="http://cn.faceplusplus.com/dev/getting-started/core-concept/" target="_blank" rel="noopener">官方文档</a>。            </p><p>查询URL示例：<a href="http://apicn.faceplusplus.com/v2/detection/detect?api_key=93fccb5a8b923956b0b6c5c8d416f0d1&amp;api_secret=5ib4xNwJtOkWY_0JLSZye4eod33YhsT2&amp;url=http://img.sucai.redocn.com/attachments/images/201204/20120417/Redocn_2012041310435227.jpg&amp;attribute=glass,pose,landmark,gender,age,race,smiling" target="_blank" rel="noopener">http://apicn.faceplusplus.com/v2/detection/detect?api_key=93fccb5a8b923956b0b6c5c8d416f0d1&amp;api_secret=5ib4xNwJtOkWY_0JLSZye4eod33YhsT2&amp;url=http://img.sucai.redocn.com/attachments/images/201204/20120417/Redocn_2012041310435227.jpg&amp;attribute=glass,pose,landmark,gender,age,race,smiling</a><br>结果分析：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"face"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"attribute"</span>: &#123;</span><br><span class="line">                <span class="attr">"age"</span>: &#123; <span class="attr">"range"</span>: <span class="number">5</span>,  <span class="attr">"value"</span>: <span class="number">18</span> &#125;, </span><br><span class="line">                <span class="attr">"gender"</span>: &#123; <span class="attr">"confidence"</span>: <span class="number">99.9997</span>,  <span class="attr">"value"</span>: <span class="string">"Female"</span>  &#125;, </span><br><span class="line">                <span class="attr">"glass"</span>: &#123;<span class="attr">"confidence"</span>: <span class="number">99.6323</span>, <span class="attr">"value"</span>: <span class="string">"None"</span>  &#125;, </span><br><span class="line">                <span class="attr">"landmark"</span>: &#123;</span><br><span class="line">                    <span class="attr">"left_eye_bottom"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">38.091224</span>,   <span class="attr">"y"</span>: <span class="number">35.733333</span> &#125;, </span><br><span class="line">                    <span class="attr">"left_eye_center"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">37.96097</span>,   <span class="attr">"y"</span>: <span class="number">34.152667</span> &#125;, </span><br><span class="line">                    <span class="attr">"left_eye_left_corner"</span>: &#123; <span class="attr">"x"</span>: <span class="number">31.142725</span>,    <span class="attr">"y"</span>: <span class="number">34.392</span>  &#125;, </span><br><span class="line">                    <span class="attr">"left_eye_pupil"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">37.936028</span>,  <span class="attr">"y"</span>: <span class="number">33.488833</span>  &#125;, </span><br><span class="line">                    <span class="attr">"left_eye_right_corner"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">44.779215</span>,   <span class="attr">"y"</span>: <span class="number">33.913167</span>  &#125;, </span><br><span class="line">                    <span class="attr">"left_eye_top"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">37.607852</span>,  <span class="attr">"y"</span>: <span class="number">31.502833</span> &#125;, </span><br><span class="line">                    <span class="attr">"left_eyebrow_left_corner"</span>: &#123; <span class="attr">"x"</span>: <span class="number">27.275751</span>,    <span class="attr">"y"</span>: <span class="number">29.799167</span>  &#125;, </span><br><span class="line">                    <span class="attr">"left_eyebrow_right_corner"</span>: &#123;   <span class="attr">"x"</span>: <span class="number">46.726559</span>, </span><br><span class="line">                        <span class="attr">"y"</span>: <span class="number">29.188833</span></span><br><span class="line">                    &#125;, </span><br><span class="line">                    <span class="attr">"mouth_left_corner"</span>: &#123;</span><br><span class="line">                        <span class="attr">"x"</span>: <span class="number">44.079677</span>, </span><br><span class="line">                        <span class="attr">"y"</span>: <span class="number">57.167</span></span><br><span class="line">                </span><br><span class="line">......</span><br><span class="line">                <span class="string">"pose"</span>: &#123;</span><br><span class="line">                    <span class="attr">"pitch_angle"</span>: &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="number">8.50726e-06</span></span><br><span class="line">                    &#125;, </span><br><span class="line">                    <span class="attr">"roll_angle"</span>: &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="number">-0.609764</span></span><br><span class="line">                    &#125;, </span><br><span class="line">                    <span class="attr">"yaw_angle"</span>: &#123;</span><br><span class="line">                        <span class="attr">"value"</span>: <span class="number">11</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="attr">"race"</span>: &#123;</span><br><span class="line">                    <span class="attr">"confidence"</span>: <span class="number">88.9365</span>, </span><br><span class="line">                    <span class="attr">"value"</span>: <span class="string">"White"</span></span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="attr">"smiling"</span>: &#123;</span><br><span class="line">                    <span class="attr">"value"</span>: <span class="number">4.79256</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, </span><br><span class="line">            <span class="attr">"face_id"</span>: <span class="string">"7493c03308095fa857ab2d1601e9fb40"</span>, </span><br><span class="line">            <span class="attr">"position"</span>: &#123;</span><br><span class="line">                <span class="attr">"center"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">52.078522</span>, <span class="attr">"y"</span>: <span class="number">43.083333</span>    &#125;, </span><br><span class="line">                <span class="attr">"eye_left"</span>: &#123;   <span class="attr">"x"</span>: <span class="number">37.96097</span>,      <span class="attr">"y"</span>: <span class="number">34.152667</span>  &#125;, </span><br><span class="line">                <span class="attr">"eye_right"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">67.255889</span>,  <span class="attr">"y"</span>: <span class="number">33.927667</span>  &#125;, </span><br><span class="line">                <span class="attr">"height"</span>: <span class="number">39.5</span>, </span><br><span class="line">                <span class="attr">"mouth_left"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">44.079677</span>,   <span class="attr">"y"</span>: <span class="number">57.167</span> &#125;, </span><br><span class="line">                <span class="attr">"mouth_right"</span>: &#123;  <span class="attr">"x"</span>: <span class="number">65.088915</span>,    <span class="attr">"y"</span>: <span class="number">56.117167</span>   &#125;, </span><br><span class="line">                <span class="attr">"nose"</span>: &#123;   <span class="attr">"x"</span>: <span class="number">53.818938</span>,  <span class="attr">"y"</span>: <span class="number">44.897333</span>  &#125;, </span><br><span class="line">                <span class="attr">"width"</span>: <span class="number">54.734411</span></span><br><span class="line">            &#125;, </span><br><span class="line">            <span class="attr">"tag"</span>: <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">    ], </span><br><span class="line">    <span class="attr">"img_height"</span>: <span class="number">830</span>, </span><br><span class="line">    <span class="attr">"img_id"</span>: <span class="string">"63d9362ea88e3c35c02b4ea8c79247d1"</span>, </span><br><span class="line">    <span class="attr">"img_width"</span>: <span class="number">600</span>, </span><br><span class="line">    <span class="attr">"session_id"</span>: <span class="string">"5bef10d1e65645548055fb3fd252f0a5"</span>, </span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"http://img.sucai.redocn.com/attachments/images/201204/20120417/Redocn_2012041310435227.jpg"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="baidu-人脸API"><a href="#baidu-人脸API" class="headerlink" title="baidu 人脸API"></a>baidu 人脸API</h3><p>百度人脸API，人脸格式化数据比Face++的少，也没有其他扩展的API（在其刚推出时试用过）。<br><a href="http://developer.baidu.com/cloud/media" target="_blank" rel="noopener">参考文档</a><br><a href="http://bcs.duapp.com/cplat-01/mediacloud/face/%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%ABREST_API%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3_v1.02.pdf" target="_blank" rel="noopener">人脸识别REST\ API帮助文档.pdf</a></p><p>申请baidu人脸识别API（新版管理平台中点击媒体云进入）：<br><a href="http://developer.baidu.com/console#newmedia/face/service!appid=1306930" target="_blank" rel="noopener">http://developer.baidu.com/console#newmedia/face/service!appid=1306930</a></p><p>申请通过在开发者网站首页-&gt;消息中心收到通知：</p><blockquote><p>应用《随手查查》的“人脸识别API”API权限申请对接成功<br>时间：2013-10-17 16:22<br>亲爱的开发者：</p><p>恭喜您，应用《随手查查》的“人脸识别API”API权限申请信息对接成功，“人脸识别API”权限已开启，请前往 控制台-高蛋白助手-API管理 查看。</p><p>百度开发者中心</p></blockquote><p>Baidu BAE控制台API管理<a href="http://developer.baidu.com/dev#/api/1306930/list" target="_blank" rel="noopener">页面</a> ,API TOKEN获取：<a href="https://openapi.baidu.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=ANGEgE28iVZYfWqOY80ih0Az&amp;client_secret=5hmFiSRasZgysAca6ExIdv89BfTyG2RW&amp;" target="_blank" rel="noopener">API</a></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"expires_in"</span>:<span class="number">2592000</span>,</span><br><span class="line"><span class="attr">"refresh_token"</span>:<span class="string">"4.ab4354e2545382b48013925c5c200b73.315360000.1697428984.282335-1306930"</span>,</span><br><span class="line"><span class="attr">"access_token"</span>:<span class="string">"3.59af4cc25f0c6397b9013dd0b0d60638.2592000.1384660984.282335-1306930"</span>,</span><br><span class="line"><span class="attr">"session_secret"</span>:<span class="string">"f3999ceb76fbbd86d0806ff9b29a81b7"</span>,</span><br><span class="line"><span class="attr">"session_key"</span>:<span class="string">"94rmKleH9+FtnYAQbkzv41BxHhIrh5U7BCNykDa0H\/Bf7AKYaywg6AEYYcfyGTJ0xIp76EER6axW1CcKrPY+2ZUrFVo="</span>,</span><br><span class="line"><span class="attr">"scope"</span>:<span class="string">"public wise_adapt media_face"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>scope: <a href="http://developer.baidu.com/wiki/index.php?title=docs/oauth/list" target="_blank" rel="noopener">http://developer.baidu.com/wiki/index.php?title=docs/oauth/list</a>  </p><p>请求示例: <a href="https://openapi.baidu.com/rest/2.0/media/v1/face/detect?access_token=3.59af4cc25f0c6397b9013dd0b0d60638.2592000.1384660984.282335-1306930&amp;url=http://c.hiphotos.bdimg.com/album/s%3D800/sign=6bd70c1da044ad342abf8a87e0a00c08/8d5494eef01f3a29d7017b3e9825bc315d607c71.jpg" target="_blank" rel="noopener">https://openapi.baidu.com/rest/2.0/media/v1/face/detect?access_token=3.59af4cc25f0c6397b9013dd0b0d60638.2592000.1384660984.282335-1306930&amp;url=http://c.hiphotos.bdimg.com/album/s%3D800/sign=6bd70c1da044ad342abf8a87e0a00c08/8d5494eef01f3a29d7017b3e9825bc315d607c71.jpg</a>  </p><p>注意:query string 需要先进行 urlencode</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">"face":[&#123;  //在原图片中检测到的人脸数组</span><br><span class="line">    "face_id":"e4fbc65ac9ea4135a9c4cda0294ccd5f",</span><br><span class="line">    "attribute":&#123;</span><br><span class="line">        "gender":&#123;"confidence":"0.558445","value":"male"&#125;,  //检测到的人脸的性别及置信度</span><br><span class="line">        "smiling":&#123;"confidence":"0.140648"&#125;,  //检测到的笑脸及置信度</span><br><span class="line">        "face":&#123;"value":"true","confidence":"1"&#125; / /？</span><br><span class="line">    &#125;,</span><br><span class="line">    "position":&#123; //检测到的人脸的位置,坐标均进行了归一化,值在 0~1 之间，中心坐标</span><br><span class="line">        "center":&#123;"x":"0.389400","y":"0.403700"&#125;,/ /人脸区域中心 坐标</span><br><span class="line">        "width":"0.353520",  //人脸区域宽</span><br><span class="line">        "height":"0.243930", //人脸区域宽</span><br><span class="line">        "eye_left":&#123;"x":"0.284900","y":"0.354970"&#125;,</span><br><span class="line">        "eye_right":&#123;"x":"0.449460","y":"0.344870"&#125;,</span><br><span class="line">        "mouth":&#123;"x":"0.373490","y":"0.482450"&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;],</span><br><span class="line">"img_id":"2b0e035557a04ad49e6f054f2556e4b6",</span><br><span class="line">"url":"http:\/\/c.hiphotos.bdimg.com\/album\/s=800\/sign=6bd70c1da044ad342abf8a87e0a00c08\/8d5494eef01f3a29d7017b3e9825bc315d607c71.jpg",  //请求中的图片 url</span><br><span class="line">"session_id":"16d2e9271173dc7c307b7cd2be4328e5",  //唯一标识请求，目前好像没有价值</span><br><span class="line">"img_width":"138",  </span><br><span class="line">"img_height":"200"  //图片宽度</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="通过关键字搜索相关图片API"><a href="#通过关键字搜索相关图片API" class="headerlink" title="通过关键字搜索相关图片API"></a>通过关键字搜索相关图片API</h2><h3 id="baidu-图片搜索API（非以图搜图）"><a href="#baidu-图片搜索API（非以图搜图）" class="headerlink" title="baidu 图片搜索API（非以图搜图）"></a>baidu 图片搜索API（非以图搜图）</h3><p>大部分的网民都喜欢看图片胜过看文字，尤其是美女这类信息，图片来的更为直接一些。</p><p>所以图片搜索就变得非常重要了。</p><p>百度图片搜索官方并没有开放API出来，但我们可以直接使用它的ajax请求网址作为api使用，因为它返回的数据格式是json格式的，它是非常通用的数据格式。</p><p>百度图片搜索API地址]<br><a href="http://image.baidu.com/i?tn=baiduimagejson&amp;ct=201326592&amp;cl=2&amp;lm=-1&amp;st=-1&amp;fm=result&amp;fr=&amp;sf=1&amp;fmq=1349413075627_R&amp;pv=&amp;ic=0&amp;nc=1&amp;z=&amp;se=1&amp;showtab=0&amp;fb=0&amp;width=&amp;height=&amp;face=0&amp;istype=2&amp;word=girl&amp;rn=2&amp;pn=1" target="_blank" rel="noopener">http://image.baidu.com/i?tn=baiduimagejson&amp;ct=201326592&amp;cl=2&amp;lm=-1&amp;st=-1&amp;fm=result&amp;fr=&amp;sf=1&amp;fmq=1349413075627_R&amp;pv=&amp;ic=0&amp;nc=1&amp;z=&amp;se=1&amp;showtab=0&amp;fb=0&amp;width=&amp;height=&amp;face=0&amp;istype=2&amp;word=girl&amp;rn=2&amp;pn=1</a>  </p><p>主要参数：<br>word，查询关键词<br>rn，每页显示图片数量<br>pn，图片显示的页码</p><p>其它参数照抄上述api地址中的就行。</p><p>##参考：<br><a href="http://2sitebbs.com/thread-695-1-1.html" target="_blank" rel="noopener">http://2sitebbs.com/thread-695-1-1.html</a></p>]]></content>
    
    <summary type="html">
    
      使用Google或Baidu的以图搜图搜索女神的头像，便可尽收网络上该女神的所有&quot;隐私&quot;...，以图搜图隐私问题突出，各家都没有公开公共API，但多想想还是有办法的。 
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="API" scheme="http://goodbai.com/tags/API/"/>
    
      <category term="以图搜图" scheme="http://goodbai.com/tags/%E4%BB%A5%E5%9B%BE%E6%90%9C%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>百科_翻译_黄历API分析和常用符号表</title>
    <link href="http://goodbai.com/2014/02/12/Baike_Translation_LunarAPI/"/>
    <id>http://goodbai.com/2014/02/12/Baike_Translation_LunarAPI/</id>
    <published>2014-02-11T16:00:00.000Z</published>
    <updated>2018-03-24T04:56:25.171Z</updated>
    
    <content type="html"><![CDATA[<p>微信公共号提供百科、中英翻译以及老黄历查询，是一件很有意思也有的事。以前与朋友聊天听到一个新的网络词汇，只能一头雾水，现今你可以轻松掏出手机，向微信公共号『随手查查』回复”白富美“（这里是例举），就一切明白了。</p><p>本文主要介绍：</p><ol><li>百度百科API使用方法;</li><li>有道翻译API使用方法;</li><li>老黄历API方案;</li><li>个人收集的常用符号表。</li></ol><p>中文百科网站主要有三家，<a href="http://baike.baidu.com/link?url=C1JNg9D7uiwZ1U02QUuhMzpnHM_knIaPNC-Uqj5CsrP_39qb8kzE410j8gke5tOoienLhhWrYnqLkb3HhiUQua" target="_blank" rel="noopener">百度百科</a>、<a href="http://zh.wikipedia.org/w/index.php?search=%E7%99%BD%E5%AF%8C%E7%BE%8E&amp;title=Special%3A%E6%90%9C%E7%B4%A2" target="_blank" rel="noopener">维基百科</a>和<a href="http://www.baike.com/wiki/%E7%99%BD%E5%AF%8C%E7%BE%8E&amp;prd=button_doc_jinru" target="_blank" rel="noopener">互动百科</a>。  </p><h2 id="维基百科API分析（wikipedia）"><a href="#维基百科API分析（wikipedia）" class="headerlink" title="维基百科API分析（wikipedia）"></a>维基百科API分析（wikipedia）</h2><p>没有详细分析。<br>IBM Blog参考：<a href="http://www.ibm.com/developerworks/cn/xml/x-phpwikipedia/" target="_blank" rel="noopener">http://www.ibm.com/developerworks/cn/xml/x-phpwikipedia/</a><br>形如：<a href="http://git.oschina.net/goodbai/goodbai-wiki/wikis/pages" target="_blank" rel="noopener">http://git.oschina.net/goodbai/goodbai-wiki/wikis/pages</a><br>API Ref: <a href="http://www.mediawiki.org/wiki/API" target="_blank" rel="noopener">http://www.mediawiki.org/wiki/API</a>  </p><p>##互动百科API分析<br>当前没有研究。</p><p>##百度百科API分析<br>API示例：<a href="http://baike.baidu.com/api/openapi/BaikeLemmaCardApi?scope=103&amp;format=json&amp;appid=379020&amp;bk_key=%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F&amp;bk_length=600" target="_blank" rel="noopener">http://baike.baidu.com/api/openapi/BaikeLemmaCardApi?scope=103&amp;format=json&amp;appid=379020&amp;bk_key=%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F&amp;bk_length=600</a></p><p><strong>JSON数据格式分析</strong><br>该接口默认返回的数据是经escape() 函数编码的（escape可对字符串进行编码，这样就可以在所有的计算机上读取该字符串），相应使用unescape函数可解码（参考：<a href="http://www.w3school.com.cn/js/jsref_escape.asp）。" target="_blank" rel="noopener">http://www.w3school.com.cn/js/jsref_escape.asp）。</a>  </p><p>下面是“操作系统”关键词查询返回的结果：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#123;       </span><br><span class="line">        <span class="attr">"id"</span>:<span class="string">"880"</span>,</span><br><span class="line">        <span class="attr">"subLemmaId"</span>:<span class="string">"4940471"</span>,</span><br><span class="line">        "key":"\u64cd\u4f5c\u7cfb\u7edf",                    //查询词</span><br><span class="line">        "title":"\u64cd\u4f5c\u7cfb\u7edf",     </span><br><span class="line">        "card":[&#123;</span><br><span class="line">                "key":"m25_nameC",</span><br><span class="line">                "name":"\u4e2d\u6587\u540d",                //中文名称</span><br><span class="line">                "value":["\u64cd\u4f5c\u7cfb\u7edf"],</span><br><span class="line">                "format":["\u64cd\u4f5c\u7cfb\u7edf"]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="attr">"key"</span>:<span class="string">"m25_nameE"</span>,</span><br><span class="line">                "name":"\u5916\u6587\u540d",                //英文名称</span><br><span class="line">                "value":["Operating System&lt;\/a&gt;"],</span><br><span class="line">                "format":["Operating System&lt;\/a&gt;"]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="attr">"key"</span>:<span class="string">"m25_ext_0"</span>,</span><br><span class="line">                "name":"\u82f1\u6587\u7b80\u79f0",       //英文简称</span><br><span class="line">                "value":["OS&lt;\/a&gt;"],</span><br><span class="line">                "format":["OS&lt;\/a&gt;"]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="attr">"key"</span>:<span class="string">"m25_ext_1"</span>,</span><br><span class="line">                "name":"\u7ec4\u6210\u90e8\u5206",     //组成部分</span><br><span class="line">                "value":["\u5185\u6838&lt;\/a&gt;\u3001\u9a71\u52a8\u7a0b\u5e8f&lt;\/a&gt;\u3001\u63a5\u53e3\u5e93\u3001\u5916\u56f4"],</span><br><span class="line">                "format":["\u5185\u6838&lt;\/a&gt;\u3001\u9a71\u52a8\u7a0b\u5e8f&lt;\/a&gt;\u3001\u63a5\u53e3\u5e93\u3001\u5916\u56f4"]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="attr">"key"</span>:<span class="string">"m25_ext_2"</span>,</span><br><span class="line">                "name":"\u5e38\u89c1\u7cfb\u7edf",          //常见系统</span><br><span class="line">                "value":["Android&lt;\/a&gt;, iOS&lt;\/a&gt;, Linux&lt;\/a&gt;, Windows&lt;\/a&gt;"],"format":["Android&lt;\/a&gt;, iOS&lt;\/a&gt;, Linux&lt;\/a&gt;, Windows&lt;\/a&gt;"]</span><br><span class="line">        &#125;],</span><br><span class="line">        "image":"http:\/\/imgsrc.baidu.com\/baike\/pic\/item\/f11f3a292df5e0fedeceedfa5c6034a85fdf7272.jpg",</span><br><span class="line">        "imageHeight":"400",</span><br><span class="line">        "imageWidth":"450",</span><br><span class="line">        "isSummaryPic":"y",</span><br><span class="line"> //介绍       "abstract":"\u64cd\u4f5c\u7cfb\u7edf\u662f\u7ba1\u7406\u8ba1\u7b97\u673a\u786c\u4ef6\u8d44\u6e90\uff0c\u63a7\u5236\u5176\u4ed6\u7a0b\u5e8f\u8fd0\u884c\u5e76\u4e3a\u7528\u6237\u63d0\u4f9b\u4ea4\u4e92\u64cd\u4f5c\u754c\u9762\u7684\u7cfb\u7edf\u8f6f\u4ef6\u7684\u96c6\u5408\u3002\u64cd\u4f5c\u7cfb\u7edf\u662f\u8ba1\u7b97\u673a\u7cfb\u7edf\u7684\u5173\u952e\u7ec4\u6210\u90e8\u5206\uff0c\u8d1f\u8d23\u7ba1\u7406\u4e0e\u914d\u7f6e\u5185\u5b58\u3001\u51b3\u5b9a\u7cfb\u7edf\u8d44\u6e90\u4f9b\u9700\u7684\u4f18\u5148\u6b21\u5e8f\u3001\u63a7\u5236\u8f93\u5165\u4e0e\u8f93\u51fa\u8bbe\u5907\u3001\u64cd\u4f5c\u7f51\u7edc\u4e0e\u7ba1\u7406\u6587\u4ef6\u7cfb\u7edf\u7b49\u57fa\u672c\u4efb\u52a1\u3002\u64cd\u4f5c\u7cfb\u7edf\u7684\u79cd\u7c7b\u5f88\u591a\uff0c\u5404\u79cd\u8bbe\u5907\u5b89\u88c5\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ece\u7b80\u5355\u5230\u590d\u6742\uff0c\u53ef\u4ece\u624b\u673a\u7684\u5d4c\u5165\u5f0f\u64cd\u4f5c\u7cfb\u7edf\u5230\u8d85\u7ea7\u8ba1\u7b97\u673a\u7684\u5927\u578b\u64cd\u4f5c\u7cfb\u7edf\u3002\u76ee\u524d\u6d41\u884c\u7684\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u4e3b\u8981\u6709Android\u3001BSD\u3001iOS\u3001Linux\u3001Mac OS X\u3001Windows\u3001Windows Phone\u548cz\/OS\u7b49\uff0c\u9664\u4e86Windows\u548cz\/OS\u7b49\u5c11\u6570\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5927\u90e8\u5206\u64cd\u4f5c\u7cfb\u7edf\u90fd\u4e3a\u7c7bUnix\u64cd\u4f5c\u7cfb\u7edf\u3002",</span><br><span class="line">        "catalog":["\u7b80\u4ecb&lt;\/a&gt;","\u53d1\u5c55\u5386\u53f2&lt;\/a&gt;","\u7ec4\u6210\u90e8\u5206&lt;\/a&gt;","\u5185\u6838\u7ed3\u6784&lt;\/a&gt;"],  //章节标题</span><br><span class="line">        "url":"http:\/\/baike.baidu.com\/view\/880.htm",</span><br><span class="line">        "hasOther":"1",</span><br><span class="line">        "subLemma":"",</span><br><span class="line">        "logo":"http:\/\/img.baidu.com\/img\/baike\/logo-baike.gif",</span><br><span class="line"> //百度版权声明       "copyrights":"\u4ee5\u4e0a\u5185\u5bb9\u6765\u81ea\u767e\u5ea6\u767e\u79d1\u5e73\u53f0\uff0c\u7531\u767e\u5ea6\u767e\u79d1\u7f51\u53cb\u521b\u4f5c\u3002"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>查询出错示例如下：<a href="http://baike.baidu.com/api/openapi/BaikeLemmaCardApi?scope=103&amp;format=json&amp;appid=379020&amp;bk_key=%E6%88%91%E4%BB%AC%E9%83%BD%E6%98%AF%E4%B8%AD%E5%9B%BD%E4%BA%BA%E7%9A%84%E5%9B%9B%20%20%20%E5%A4%A7%E6%9B%B4%E5%A4%9A%E9%98%BF%E8%BE%BE%E4%B8%89%E4%B8%AA&amp;bk_length=600" target="_blank" rel="noopener">查看原始页面</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;error_code&quot;:&quot;20000&quot;,&quot;error_msg&quot;:&quot;search word not found&quot;&#125;</span><br></pre></td></tr></table></figure></p><p>##翻译功能</p><p>###百度翻译</p><p>百度翻译内容比较简单，中译英或英译中结果一般只有一个词（或一句话），没有音标、相近词、用法等信息。<br>一篇参考：<a href="http://www.cnblogs.com/mchina/p/3170565.html" target="_blank" rel="noopener">http://www.cnblogs.com/mchina/p/3170565.html</a><br>baidu翻译官方：<a href="http://developer.baidu.com/wiki/index.php?title=帮助文档首页/百度翻译/翻译API" target="_blank" rel="noopener">http://developer.baidu.com/wiki/index.php?title=帮助文档首页/百度翻译/翻译API</a></p><p>###有道翻译<br>有道翻译内容比较丰富，既有释意，也有音标、相近词、用法等信息。<br>官方页面：<a href="http://fanyi.youdao.com/openapi?path=data-mode" target="_blank" rel="noopener">http://fanyi.youdao.com/openapi?path=data-mode</a><br>API示例：<a href="http://fanyi.youdao.com/fanyiapi.do?keyfrom=goodbaiA&amp;key=2122702772&amp;type=data&amp;doctype=json&amp;version=1.1&amp;q=翻译" target="_blank" rel="noopener">http://fanyi.youdao.com/fanyiapi.do?keyfrom=goodbaiA&amp;key=2122702772&amp;type=data&amp;doctype=json&amp;version=1.1&amp;q=翻译</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;translation&quot;:[&quot;translation&quot;],</span><br><span class="line">    &quot;basic&quot;:&#123;</span><br><span class="line">        &quot;phonetic&quot;:&quot;fān yì&quot;,</span><br><span class="line">        &quot;explains&quot;:[&quot;translate&quot;,&quot;interpret&quot;]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;query&quot;:&quot;翻译&quot;,</span><br><span class="line">    &quot;errorCode&quot;:0,</span><br><span class="line">    &quot;web&quot;:[</span><br><span class="line">        &#123;&quot;value&quot;:[&quot;Translation&quot;,&quot;translate&quot;,&quot;Translator&quot;],&quot;key&quot;:&quot;翻译&quot;&#125;,</span><br><span class="line">        &#123;&quot;value&quot;:[&quot;Machine translation&quot;,&quot;mechanical translation&quot;,&quot;Machinery-Translating&quot;],&quot;key&quot;:&quot;机器翻译&quot;&#125;,</span><br><span class="line">        &#123;&quot;value&quot;:[&quot;Translation memory&quot;,&quot;Translation memories&quot;,&quot;Translation memory manager&quot;],&quot;key&quot;:&quot;翻译记忆&quot;&#125; </span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>示例二  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;translation&quot;:[&quot;狼&quot;],</span><br><span class="line">    &quot;basic&quot;:&#123;</span><br><span class="line">        &quot;phonetic&quot;:&quot;wʊlf&quot;,</span><br><span class="line">        &quot;explains&quot;:[&quot;n. 狼；色狼；残忍贪婪之人&quot;,&quot;vt. 大吃；狼吞虎咽地吃&quot;]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;query&quot;:&quot;wolf&quot;,</span><br><span class="line">    &quot;errorCode&quot;:0,</span><br><span class="line">    &quot;web&quot;:[</span><br><span class="line">        &#123;&quot;value&quot;:[&quot;狼&quot;,&quot;沃尔夫&quot;,&quot;狼与美女&quot;],&quot;key&quot;:&quot;wolf&quot;&#125;,</span><br><span class="line">        &#123;&quot;value&quot;:[&quot;艾瑞克·沃尔夫&quot;,&quot;沃尔夫&quot;,&quot;伍尔夫&quot;],&quot;key&quot;:&quot;Eric Wolf&quot;&#125;,</span><br><span class="line">        &#123;&quot;value&quot;:[&quot;埃塞俄比亚狼&quot;,&quot;衣索比亚狼&quot;,&quot;西门豺&quot;],&quot;key&quot;:&quot;Ethiopian wolf&quot;&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="农历的实现"><a href="#农历的实现" class="headerlink" title="农历的实现"></a>农历的实现</h2><p>农历和公历间可通过算法对应，参考该项目实现：<a href="https://github.com/dfar2008/c3crm/blob/4f68a942f28ca935439a9b34e9834819a4726f1c/modules/Memdays/Lunar.php" target="_blank" rel="noopener">https://github.com/dfar2008/c3crm/blob/4f68a942f28ca935439a9b34e9834819a4726f1c/modules/Memdays/Lunar.php</a></p><p>###汉典老黄历API<br><a href="http://www.zdic.net/appendix/f27.htm" target="_blank" rel="noopener">汉典</a>，其提供老黄历chm文件下载，其他资源也不错（包括字典，词典等）。<br>分析其老黄历访问接口：<a href="http://www.zdic.net/nongli/inc/ll2.asp" target="_blank" rel="noopener">http://www.zdic.net/nongli/inc/ll2.asp</a><br>汉典老黄历API：<a href="http://www.zdic.net/nongli/2014-10-14.htm" target="_blank" rel="noopener">http://www.zdic.net/nongli/2014-10-14.htm</a> （这个接口不错）  </p><h2 id="附录1：参考资料"><a href="#附录1：参考资料" class="headerlink" title="附录1：参考资料"></a>附录1：参考资料</h2><p>收集一些特殊的符号: <a href="http://dev.yesky.com/89/33282589.shtml" target="_blank" rel="noopener">http://dev.yesky.com/89/33282589.shtml</a><br>百度百科API参考：<a href="https://github.com/yansunrong/baike/blob/master/content_scripts/baike.js" target="_blank" rel="noopener">https://github.com/yansunrong/baike/blob/master/content_scripts/baike.js</a>  </p><h2 id="附录2：一些有意思的符号集合"><a href="#附录2：一些有意思的符号集合" class="headerlink" title="附录2：一些有意思的符号集合"></a>附录2：一些有意思的符号集合</h2><p>通过组合符号等方法，可实现创意表达方法，微信可以很好的识别下面的符号，而且还对一些符号作了夸张的修饰。<br>如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">,　-----　､ </span><br><span class="line">　　　　　　　　____／〃&quot;　　､､､　ヽ </span><br><span class="line">　　　　　　∠＞　｀￣￣｀ヽ, --z _ i </span><br><span class="line">　　　　 ／ ,＞　　　　　　　　　　 ヽ ￣＼ </span><br><span class="line">　 　　./,∠. 　　　人　 ､　　　゛゛゛　ヽ゛､ ヽ </span><br><span class="line">　　　/　_ノ .　　/ 　|　/|人　　゛゛゛　|　　　i 　　　＿＿＿＿＿ </span><br><span class="line">　　　|　　〉/　./|　　ﾚ´／　｀ヽ λ　│ |　|i | 　／ </span><br><span class="line">　　　i ll 〈/| 　|‐ヽ　　 , ― ､　|ﾉ | 　丿| |┤| ＜　人は死ぬぞ </span><br><span class="line">　 　 |　　　|人′・ﾉ 　　､・_丿　/ヽ,ノ ﾚ ､/ 　　＼＿＿＿＿＿ </span><br><span class="line">　　　ゞ､ ゛　 　|　ヽ　　　　, メ　б│､|　&quot;/ </span><br><span class="line">　　　　 ＼゛､　ヽ　　ー　　　　 ゝ.ノ &quot;　 ／ </span><br><span class="line">　　　　　　｀‐ヽ _＼ _　＿　ノ ／ﾚ&apos;__／ </span><br><span class="line">　　　 　 　　　　　　 　|　 　　.| </span><br><span class="line">　　　　　　　　　______.ﾉ 　 　 人(⌒) </span><br><span class="line">　　　　　　　 ／/::::::::|-､ ,-/::::::ﾉ ~.ﾚ-r┐ </span><br><span class="line">　　　　　　 /　/:::::::::::|　　/:::::ノ__　|　.|　ﾄ､ </span><br><span class="line">　　　　　　 | /:::::::::::::::|　〈￣ 　　｀-Lλ_ﾚ′ </span><br><span class="line">　　　　　　 ﾚ::::::::::::::::::|/:::￣｀ー‐---‐′</span><br></pre></td></tr></table></figure></p><p>部分符号集合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">、。·ˉˇ¨〃々—～‖…‘’“”〔〕〈 〉《》「」『』〖〗【】±+-×÷∧∨∑∏∪∩∈√⊥∥∠⌒⊙∫∮≡≌≈∽∝≠≮≯≤≥∞∶ ∵∴∷♂♀°</span><br><span class="line">′″℃$¤￠￡‰§№☆★〇○●◎◇◆ 回□■△▽⊿▲▼◣◤◢◥▁▂▃▄▅▆▇█▉▊▋▌▍▎▏▓※→←↑↓↖↗↘↙〓 ⅰⅱⅲⅳⅴⅵⅶⅷⅸⅹ①②③④⑤⑥⑦⑧⑨⑩</span><br><span class="line">⒈⒉⒊⒋ ⒌⒍⒎⒏⒐⒑⒒⒓⒔⒕⒖⒗⒘⒙⒚⒛⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂⒃⒄⒅⒆⒇㈠㈡㈢㈣㈤㈥㈦㈧㈨㈩</span><br><span class="line">ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅪⅫ!&quot;#￥%&amp;&apos;()*+，-./0123456789：;&lt;=&gt;？@ABCDEFGHIJLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|｝</span><br><span class="line">ぁあぃいぅうぇえぉおかがきぎくぐけげこごさざしじすずせぜそぞただちぢっつづてでとどなにぬねのはばぱひびぴふぶぷ</span><br><span class="line">へべぺほぼぽまみむめもゃやゅゆょよらりるれろゎわゐゑをんァアィイゥウェエォオカガキギクグケゲコゴ</span><br><span class="line">サザシジスズセゼソゾタダチヂッツヅテデトドナニヌネノハバパヒビピフブ</span><br><span class="line">プヘベペホボポマミムメモャヤュユョヨラリルレロヮワヰヱヲンヴヵヶΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩαβγδεζηθ ικλμνξοπρστυφχψ </span><br><span class="line">ω︵︶︹︺︿﹀︽︾﹁﹂﹃﹄︻︼︷︸АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийклмнопрстуфхцчшщъыь эюāáǎàēéěèī </span><br><span class="line">íǐìōóǒòūúǔùǖǘǚǜüêɑńňɡㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄘㄙㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦㄧㄨㄩ︱︳︴﹏﹋﹌─━│┃┄┅┆ </span><br><span class="line">┇┈┉┊┋┌┍┎┏┐┑┒┓└┕┖┗┘┙┚┛├┝┞┟┠┡┢┣┤┥┦┧┨┩┪┫┬┭┮┯┰┱┲┳┴┵┶┷┸┹┺┻┼┽┾┿╀╁╂╃╄ ╅╆╇╈╉╊╋？㊣㈱曱甴囍∟┅﹊﹍╭ ╮╰ ╯ _ ^︵^﹕﹗</span><br><span class="line">/\ &quot; &lt; &gt; `,·。&#123;&#125;~～() -√ $ @ * &amp; # 卐℡ ぁ〝〞ミ灬№*ㄨ≮≯ ﹢﹣/∝≌∽≦≧≒﹤﹥じぷ┗┛￥￡§я-―‥…‰′″℅℉</span><br><span class="line">№℡∕∝∣═║╒╓╔╕╖╗╘╙╚╛╜╝╞╟╠╡╢╣╤╥╦╧╨╩╪╫╬╱ ╲╳▔▕〆〒〡〢〣〤〥〦〧〨〩㎎ ㎏ ㎜ ㎝ ㎞ ㎡ ㏄ ㏎㏑㏒㏕</span><br><span class="line">兀︰﹍﹎ ------</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
       主要介绍百度百科API使用方法，有道翻译API使用方法和老黄历API使用，另外再附一个有用的符号表。
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="API" scheme="http://goodbai.com/tags/API/"/>
    
      <category term="百科" scheme="http://goodbai.com/tags/%E7%99%BE%E7%A7%91/"/>
    
      <category term="翻译" scheme="http://goodbai.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>linux桌面打印机配置指南</title>
    <link href="http://goodbai.com/2014/01/28/HowTOInstallPrinter/"/>
    <id>http://goodbai.com/2014/01/28/HowTOInstallPrinter/</id>
    <published>2014-01-27T16:00:00.000Z</published>
    <updated>2018-03-24T04:55:54.595Z</updated>
    
    <content type="html"><![CDATA[<p>目前Linux系统主流使用<a href="http://www.cups.org/" target="_blank" rel="noopener">CUPS</a>（Common Unix Printing System)打印服务系统。</p><p>##HP printer<br><a href="http://hplipopensource.com/hplip-web/index.html" target="_blank" rel="noopener">HPLIP</a>(HP Linux Imaging and Printing)开源项目提供的Linux驱动可以支持市面上大多数HP打印机，部分的打印机可能需要额外安装<strong>插件</strong>，插件一般为固件（.fw文件）或预编译的共享库（.so文件）（<strong>需要插件的设备一般不支持国产龙芯和ARM平台之类</strong>）。  </p><p>支持情况查询：<a href="http://hplipopensource.com/hplip-web/supported_devices/combined.html" target="_blank" rel="noopener">http://hplipopensource.com/hplip-web/supported_devices/combined.html</a><br>插件安装参考：<a href="http://hplipopensource.com/node/309" target="_blank" rel="noopener">http://hplipopensource.com/node/309</a><br>经分析，插件下载地址是: <a href="http://www.openprinting.org/download/printdriver/auxfiles/HP/plugins/" target="_blank" rel="noopener">http://www.openprinting.org/download/printdriver/auxfiles/HP/plugins/</a><br>安装目录: /usr/share/hplip/scan/plugins/ </p><h2 id="Canon-printer"><a href="#Canon-printer" class="headerlink" title="Canon printer"></a>Canon printer</h2><p>驱动地址：<br><a href="http://www.canon-europe.com/Support/Consumer_Products/products/printers/Laser/Laser_Shot_LBP1120.aspx?DLtcmuri=tcm:13-1060371&amp;page=1&amp;type=download#" target="_blank" rel="noopener">http://www.canon-europe.com/Support/Consumer_Products/products/printers/Laser/Laser_Shot_LBP1120.aspx?DLtcmuri=tcm:13-1060371&amp;page=1&amp;type=download#</a></p><h2 id="几个Linux重要的打印机驱动包"><a href="#几个Linux重要的打印机驱动包" class="headerlink" title="几个Linux重要的打印机驱动包"></a>几个Linux重要的打印机驱动包</h2><p>###HPLIP<br><a href="http://hplipopensource.com/hplip-web/index.html" target="_blank" rel="noopener">HPLIP</a>上面已经介绍过，HPLIP开源项目由HP官方支持，包括打印和扫描扫描设备的驱动，同时包括hp-setup/hp-check等命令可供现场适配调试用。  </p><p>###foo2zjs<br><a href="http://foo2zjs.rkkda.com/" target="_blank" rel="noopener">foo2zjs</a>，Linux著名的第三方开源打印机驱动，对于它的作者我一直没有搞清来历，只在项目主页看到一句充满愤怒的话，如下：</p><blockquote><p><strong><em> DON NOT USE the foo2zjs package from:<br>         Ubuntu, SUSE, Mandrake/Manrivia, Debian, RedHat, Fedora, Gentoo, Xandros, EEE PC, Linpus, MacOSX, or BSD!  </em></strong> Download it here and follow the directions below.  </p></blockquote><p>foo2zjs项目有几个入口，但内容都是一样的，内包含多个小模块（foo2zjs/foo2slx/foo2qpdl/foo2xqx/foo2hbpl2等），可以直接从发行版仓库安装，也可自行下载源码包安装（编译安装方法参考包内INSTALL文件或主页说明）。  </p><p><strong>注意：</strong><br>1 可能有多个驱动同时支持一款打印机；<br>2 HPLIP项目中列出需要插件的HP打印机，如果使用foo2zjs驱动，同样需要安装插件。</p><h3 id="gutenprint"><a href="#gutenprint" class="headerlink" title="gutenprint"></a>gutenprint</h3><p>没有仔细研究，建议直接通过发行版安装。</p><p>##Linux系统打印机适配流程参考<br>鉴于Linux系统小众的原因，不是市面上每一款打印机都一定能适配成功，但可参考下面方法尝试。  </p><ol><li>尽量升级驱动到最新版<br>如升级CUPS/foo2zjs/hplip/guteprint/，或者是换最新的Ubuntu/Fedora发新版。  </li><li><p>查看硬件设备是否已识别，一般OK，否则可能是设备损坏或者连接有问题。  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lsusb</span><br></pre></td></tr></table></figure></li><li><p>查看打印系统（CUPS）是否识别设备  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /usr/lib/cups/backend/usb  #针对USB打印机</span><br></pre></td></tr></table></figure></li></ol><p>如果是HP打印机，可使用hp-setup命令以向导模式安装。</p><h2 id="其他辅助操作"><a href="#其他辅助操作" class="headerlink" title="其他辅助操作"></a>其他辅助操作</h2><p>###lpadmin命令操作打印机配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/lpadmin -p TOEC--Printer -m OEP102B.ppd -v usb://TOEC/Printer  #添加  </span><br><span class="line">/usr/sbin/lpadmin -d TOEC--Printer  #设为默认</span><br></pre></td></tr></table></figure></p><p>###打印机后端调试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/lib/cups/backend/usb #发现usb打印设备  </span><br><span class="line">CUPS_DEBUG_LEVEL=2 su-c &quot; /usr/lib/cups/backend/ipp&quot; 2&gt;&amp;1 | tee snmp.log #后端调试  </span><br><span class="line">usblp.ko #默认匹配多数usb打印机，适配施乐p105b时发现，自动加载模块导致无法发现设备（移除该模块后正常）</span><br></pre></td></tr></table></figure></p><h3 id="查看CUPS日志"><a href="#查看CUPS日志" class="headerlink" title="查看CUPS日志"></a>查看CUPS日志</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/log/cups/error_log</span><br></pre></td></tr></table></figure><h3 id="Web方式管理CUPS打印系统"><a href="#Web方式管理CUPS打印系统" class="headerlink" title="Web方式管理CUPS打印系统"></a>Web方式管理CUPS打印系统</h3><p>CUPS默认开启web后台管理服务，浏览器访问<a href="http://127.0.0.1:631/" target="_blank" rel="noopener">http://127.0.0.1:631/</a>即可。  </p><h2 id="龙芯平台Canon-Laser-Shot-LBP1120-适配记录"><a href="#龙芯平台Canon-Laser-Shot-LBP1120-适配记录" class="headerlink" title="龙芯平台Canon Laser Shot LBP1120 适配记录"></a>龙芯平台Canon Laser Shot LBP1120 适配记录</h2><p>驱动地址：<a href="http://www.canon-europe.com/Support/Consumer_Products/products/printers/Laser/Laser_Shot_LBP1120.aspx?DLtcmuri=tcm:13-1060371&amp;page=1&amp;type=download#" target="_blank" rel="noopener">http://www.canon-europe.com/Support/Consumer_Products/products/printers/Laser/Laser_Shot_LBP1120.aspx?DLtcmuri=tcm:13-1060371&amp;page=1&amp;type=download#</a></p><p>###源码编译<br>README中说明了依赖、支持的设备及支持发行版情况。<br>源代码分为两部分：cndrvdups-common和cndrvcups-capt。<br>cndrvdups-common<br>参考README，执行（已完成）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">make gen</span><br><span class="line">make </span><br><span class="line">make install [DESTDIR=./root]</span><br></pre></td></tr></table></figure></p><p>cndrvcups-capt<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./allgen.sh</span><br></pre></td></tr></table></figure></p><p>错误：../libtool: line 841: X–tag=CC: command not found …<br>解决：<br>缺少$echo定义导致（有$ECHO)，在allgen.sh添加export echo=echo(make install前也要添加).  </p><p>###安装调试<br>按上面的步骤成功编译和安装驱动后，接入打印机自动生成配置，打印测试页失败。比较发现该下载包中预编译的RPM包，要多出一些文件（如/usr/bin/ccpd等），对应到源码下libs目录也有一份预编译的x86的二进制文件，看来canon驱动只是部分开放，下面的说明也验证了这个说法。</p><p><a href="http://forums.fedoraforum.org/showthread.php?t=280582" target="_blank" rel="noopener">http://forums.fedoraforum.org/showthread.php?t=280582</a><br><a href="http://www.unixmen.com/installation-canon-lbp2900-on-linux-2/" target="_blank" rel="noopener">http://www.unixmen.com/installation-canon-lbp2900-on-linux-2/</a>  </p><p>具体说，canon的这个驱动在cups和设备之间加了一个黑盒层（不开放源代码）ccpd，通过该守护进程实现功能，而该ccpd守护程序当前无法在Mips下运行。</p><p>该情况发送邮件询问canon欧洲官方支持，结果告知问题要发给canon中国解决，如下：</p><blockquote><p>Dear good bai, </p><p>Thank you for having contacted Canon Europe customer support. </p><p>In order to provide you with the best response to your query, we have forwarded your &gt;request to the local Canon Services &amp; Support organisation responsible for your &gt;geographical region. </p><p>Please do not hesitate to contact them directly at the following email address: &gt;<a href="http://www.canon.com.cn/support/service.html" target="_blank" rel="noopener">http://www.canon.com.cn/support/service.html</a></p><p>Yours sincerely, </p></blockquote><p>而canon中国根本就不提供Linux驱动的下载，该驱动就是从canon欧洲官方网站下载到的。</p><p>初步结论：该驱动不支持龙芯平台（经官方方确认）。</p><p>###UFR版驱动<br>UFR II Printer Driver for Linux Version 2.60：<a href="http://support-cn.canon-asia.com/contents/CN/ZH/0100270809.html" target="_blank" rel="noopener">http://support-cn.canon-asia.com/contents/CN/ZH/0100270809.html</a><br>Information on Printers from Canon：<a href="https://www-304.ibm.com/support/docview.wss?uid=nas8N1019527" target="_blank" rel="noopener">https://www-304.ibm.com/support/docview.wss?uid=nas8N1019527</a>  </p><p>URF驱动包与capt包类似，目前编译完成，可自动添加，开始报过滤期丢失，后来驱动无效。。。</p><p><strong>补充：canon中国客服告知，LBP2900的唯一驱动是capt（<a href="http://support-cn.canon-asia.com/contents/CN/ZH/0100459603.html，这个与canon欧洲的capt驱动完全一致）" target="_blank" rel="noopener">http://support-cn.canon-asia.com/contents/CN/ZH/0100459603.html，这个与canon欧洲的capt驱动完全一致）</a></strong></p><p><strong>结论：该Canon打印机驱动可以支持X86 Linux系统，但无法支持龙芯等国产平台（因为预编译库为x86版）</strong></p><p>##通过cups配置打印机共享</p><ul><li><p>Server端的设置<br>1 在“打印机设置”界面中，右键单击想要共享的打印机，在菜单中“共享”一项前打“√”，表示启用共享。<br>2 在“打印机设置”界面中，单击“服务器”，选择“设定”，输入root密码正确后，在弹出的“服务器设定”对话框中，勾选“发布连接到该系统的共享打印机”，其子项“允许从互联网打印”也要勾选。如果提示“更改防火墙”，选择更改防火墙。至此，server端设置完成。</p></li><li><p>Client端的设置<br>1 单击“启动”，选择“系统”—&gt;“硬件”—&gt;“打印”，打开“打印机设置”界面。<br>2 “打印机设置”界面打开后，单击“添加”按钮，输入root密码，出现“新打印机”界面<br>3 在此界面中选择“查找网络打印机”，在右边“主机”中输入server的ip地址，然后点击“查找”。<br>4 可以看到已经查找到网络打印机，单击右下角“连接”按钮，出现“IPP”选项，选择“队列”名为：/printers/HP-LaserJet-M1522nf-MFP的“IPP”。</p></li></ul><p>##扫描仪<br>关于HP扫描仪，通过与launchpad.net（hplip） 技术人员沟通知悉，hplip扫描的插件不支持mipsel架构，所以龙芯下不能扫描。<br>详见：<a href="https://answers.launchpad.net/hplip/+question/198640" target="_blank" rel="noopener">https://answers.launchpad.net/hplip/+question/198640</a></p>]]></content>
    
    <summary type="html">
    
      Linux下打印机适配难，主要是Linux版本太多，导致厂商无力也无太大兴趣关心其，个人刚好接触过这一块，专门整理一份文档方便查阅。 
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="Linux" scheme="http://goodbai.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>天气预报及环境指数开放API综合分析</title>
    <link href="http://goodbai.com/2013/12/30/UseForecastAndPMDataAPI/"/>
    <id>http://goodbai.com/2013/12/30/UseForecastAndPMDataAPI/</id>
    <published>2013-12-29T16:00:00.000Z</published>
    <updated>2018-03-24T05:00:03.465Z</updated>
    
    <content type="html"><![CDATA[<p>因微信公共号提供城市天气预报服务，发现网山天气预报接口和环境数据接口方面资料比较乱，而且有不少内容已经失效，下面内容由过程日志整理形成，希望有人可用得上。</p><p>##一 天气预报接口分析</p><p>国内的天气预报<strong>数据</strong>，主要是国家气象局和国外两个来源（指数据来源）。  </p><ul><li><strong>国外</strong>方面主要是雅虎（XML格式，谷歌已经停掉了自家的天气API）；  </li><li><strong>国内</strong>数据由国家气象局提供（JSON格式）。  </li></ul><p>在知乎看到过一篇专业人士评论，雅虎可以提供全球范围的且非常精细的天气数据（小时级更新），但主要是通过计算机自动生成。而国家气象局则是各地经验丰富的专家人士结合计算机综合分析得出，在准确性上更胜一筹。我就这样信了！  </p><p>###国家气象局天气接口</p><p>气象局的天气预报主页：[移动版] (<a href="http://mobile.weather.com.cn/city/101020100.html" target="_blank" rel="noopener">http://mobile.weather.com.cn/city/101020100.html</a>) [普通版] (<a href="http://www.weather.com.cn/" target="_blank" rel="noopener">http://www.weather.com.cn/</a>) ,仔细挖掘这两个地址可以发现很多好东西哦。    </p><p><strong>特点：接口多，来自weather.com.cn和mobile.weather.com.cn都有，次数不限制，服务稳定，功能全面，优先推荐。</strong></p><p>####1. 实时天气接口<br>有多个接口，好像差别不大：<br>实时天气1：<a href="http://www.weather.com.cn/data/sk/101190408.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/sk/101190408.html</a><br>实时天气2：<a href="http://www.weather.com.cn/data/cityinfo/101190408.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/cityinfo/101190408.html</a><br>实时天气3（带时间戳）：<a href="http://mobile.weather.com.cn/data/sk/101010100.html?_=1381891661455" target="_blank" rel="noopener">http://mobile.weather.com.cn/data/sk/101010100.html?_=1381891661455</a></p><p>####2. 一周天气预报接口 </p><ul><li>7天预报数据<br>URL： <a href="http://mobile.weather.com.cn/data/forecast/101010100.html?_=1381891660081" target="_blank" rel="noopener">http://mobile.weather.com.cn/data/forecast/101010100.html?_=1381891660081</a><br>该接口来源气象局移动版网站，目测数据最为精确，详细接口格式如下：      <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;c&quot;:&#123;&quot;c1&quot;:&quot;101010100&quot;,&quot;c2&quot;:&quot;beijing&quot;,&quot;c3&quot;:&quot;北京&quot;,&quot;c4&quot;:&quot;beijing&quot;,&quot;c5&quot;:&quot;北京&quot;,&quot;c6&quot;:&quot;beijing&quot;,&quot;c7&quot;:&quot;北京&quot;,&quot;c8&quot;:&quot;china&quot;,&quot;c9&quot;:&quot;中国&quot;,&quot;c10&quot;:&quot;1&quot;,&quot;c11&quot;:&quot;010&quot;,&quot;c12&quot;:&quot;100000&quot;,&quot;c13&quot;:&quot;116.391&quot;,&quot;c14&quot;:&quot;39.904&quot;,&quot;c15&quot;:&quot;33&quot;,&quot;c16&quot;:&quot;AZ9010&quot;,&quot;c17&quot;:&quot;+8&quot;&#125;,</span><br><span class="line">&quot;f&quot;:&#123;&quot;f1&quot;:</span><br><span class="line">    [</span><br><span class="line">    &#123;&quot;fa&quot;:&quot;01&quot;,&quot;fb&quot;:&quot;03&quot;,&quot;fc&quot;:&quot;10&quot;,&quot;fd&quot;:&quot;5&quot;,&quot;fe&quot;:&quot;0&quot;,&quot;ff&quot;:&quot;0&quot;,&quot;fg&quot;:&quot;0&quot;,&quot;fh&quot;:&quot;0&quot;,&quot;fi&quot;:&quot;06:21|17:40&quot;&#125;, </span><br><span class="line">    &#123;&quot;fa&quot;:&quot;07&quot;,&quot;fb&quot;:&quot;07&quot;,&quot;fc&quot;:&quot;19&quot;,&quot;fd&quot;:&quot;12&quot;,&quot;fe&quot;:&quot;0&quot;,&quot;ff&quot;:&quot;0&quot;,&quot;fg&quot;:&quot;0&quot;,&quot;fh&quot;:&quot;0&quot;,&quot;fi&quot;:&quot;06:22|17:38&quot;&#125;,</span><br><span class="line">    &#123;&quot;fa&quot;:&quot;02&quot;,&quot;fb&quot;:&quot;00&quot;,&quot;fc&quot;:&quot;15&quot;,&quot;fd&quot;:&quot;5&quot;,&quot;fe&quot;:&quot;8&quot;,&quot;ff&quot;:&quot;8&quot;,&quot;fg&quot;:&quot;3&quot;,&quot;fh&quot;:&quot;1&quot;,&quot;fi&quot;:&quot;06:23|17:37&quot;&#125;,</span><br><span class="line">    &#123;&quot;fa&quot;:&quot;00&quot;,&quot;fb&quot;:&quot;00&quot;,&quot;fc&quot;:&quot;16&quot;,&quot;fd&quot;:&quot;4&quot;,&quot;fe&quot;:&quot;0&quot;,&quot;ff&quot;:&quot;0&quot;,&quot;fg&quot;:&quot;0&quot;,&quot;fh&quot;:&quot;0&quot;,&quot;fi&quot;:&quot;06:24|17:35&quot;&#125;,</span><br><span class="line">    &#123;&quot;fa&quot;:&quot;00&quot;,&quot;fb&quot;:&quot;00&quot;,&quot;fc&quot;:&quot;18&quot;,&quot;fd&quot;:&quot;7&quot;,&quot;fe&quot;:&quot;0&quot;,&quot;ff&quot;:&quot;0&quot;,&quot;fg&quot;:&quot;0&quot;,&quot;fh&quot;:&quot;0&quot;,&quot;fi&quot;:&quot;06:25|17:34&quot;&#125;,</span><br><span class="line">    &#123;&quot;fa&quot;:&quot;00&quot;,&quot;fb&quot;:&quot;01&quot;,&quot;fc&quot;:&quot;18&quot;,&quot;fd&quot;:&quot;8&quot;,&quot;fe&quot;:&quot;0&quot;,&quot;ff&quot;:&quot;0&quot;,&quot;fg&quot;:&quot;0&quot;,&quot;fh&quot;:&quot;0&quot;,&quot;fi&quot;:&quot;06:26|17:32&quot;&#125;,</span><br><span class="line">    &#123;&quot;fa&quot;:&quot;01&quot;,&quot;fb&quot;:&quot;01&quot;,&quot;fc&quot;:&quot;16&quot;,&quot;fd&quot;:&quot;6&quot;,&quot;fe&quot;:&quot;0&quot;,&quot;ff&quot;:&quot;0&quot;,&quot;fg&quot;:&quot;0&quot;,&quot;fh&quot;:&quot;0&quot;,&quot;fi&quot;:&quot;06:27|17:31&quot;&#125;],</span><br><span class="line">&quot;f0&quot;:&quot;201310121100&quot;&#125;&#125;</span><br></pre></td></tr></table></figure></li></ul><p>详细接口分析如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//格式说明</span><br><span class="line">var format=&#123;fa:图片1,fb：图片2,fc:温度1,fd：温度2,fe:风向1,ff：风向2,fg:风力1,fh：风力2,fi:日出日落&#125;;  </span><br><span class="line">//定义天气类型</span><br><span class="line">var weatherArr=&#123;&quot;00&quot;:&quot;晴&quot;,&quot;01&quot;:&quot;多云&quot;,&quot;02&quot;:&quot;阴&quot;,&quot;03&quot;:&quot;阵雨&quot;,&quot;04&quot;:&quot;雷阵雨&quot;,&quot;05&quot;:&quot;雷阵雨伴有冰雹&quot;,&quot;06&quot;:&quot;雨夹雪&quot;,&quot;07&quot;:&quot;小雨&quot;,&quot;08&quot;:&quot;中雨&quot;,&quot;09&quot;:&quot;大雨&quot;,&quot;10&quot;:&quot;暴雨&quot;,&quot;11&quot;:&quot;大暴雨&quot;,&quot;12&quot;:&quot;特大暴雨&quot;,&quot;13&quot;:&quot;阵雪&quot;,&quot;14&quot;:&quot;小雪&quot;,&quot;15&quot;:&quot;中雪&quot;,&quot;16&quot;:&quot;大雪&quot;,&quot;17&quot;:&quot;暴雪&quot;,&quot;18&quot;:&quot;雾&quot;,&quot;19&quot;:&quot;冻雨&quot;,&quot;20&quot;:&quot;沙尘暴&quot;,&quot;21&quot;:&quot;小到中雨&quot;,&quot;22&quot;:&quot;中到大雨&quot;,&quot;23&quot;:&quot;大到暴雨&quot;,&quot;24&quot;:&quot;暴雨到大暴雨&quot;,&quot;25&quot;:&quot;大暴雨到特大暴雨&quot;,&quot;26&quot;:&quot;小到中雪&quot;,&quot;27&quot;:&quot;中到大雪&quot;,&quot;28&quot;:&quot;大到暴雪&quot;,&quot;29&quot;:&quot;浮尘&quot;,&quot;30&quot;:&quot;扬沙&quot;,&quot;31&quot;:&quot;强沙尘暴&quot;,&quot;53&quot;:&quot;霾&quot;,&quot;99&quot;:&quot;&quot;&#125;;  </span><br><span class="line">//定义风向数组  </span><br><span class="line">var fxArr=&#123;&quot;0&quot;:&quot;无持续风向&quot;,&quot;1&quot;:&quot;东北风&quot;,&quot;2&quot;:&quot;东风&quot;,&quot;3&quot;:&quot;东南风&quot;,&quot;4&quot;:&quot;南风&quot;,&quot;5&quot;:&quot;西南风&quot;,&quot;6&quot;:&quot;西风&quot;,&quot;7&quot;:&quot;西北风&quot;,&quot;8&quot;:&quot;北风&quot;,&quot;9&quot;:&quot;旋转风&quot;&#125;;    </span><br><span class="line">//定义风力数组  </span><br><span class="line">var flArr=&#123;&quot;0&quot;:&quot;微风&quot;,&quot;1&quot;:&quot;3-4级&quot;,&quot;2&quot;:&quot;4-5级&quot;,&quot;3&quot;:&quot;5-6级&quot;,&quot;4&quot;:&quot;6-7级&quot;,&quot;5&quot;:&quot;7-8级&quot;,&quot;6&quot;:&quot;8-9级&quot;,&quot;7&quot;:&quot;9-10级&quot;,&quot;8&quot;:&quot;10-11级&quot;,&quot;9&quot;:&quot;11-12级&quot;&#125;;</span><br></pre></td></tr></table></figure></p><ul><li>6天预报数据<br>URL： <a href="http://m.weather.com.cn/data/101190408.html" target="_blank" rel="noopener">http://m.weather.com.cn/data/101190408.html</a><br>该接口来源网络，应该是一个流传比较久的接口，大发现准确性和稳定性可能不稳定。接口分析如下：<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"weatherinfo"</span>:&#123;</span><br><span class="line">        #基本信息</span><br><span class="line">        "city":"北京","city_en":"beijing","date_y":"2013年9月24日","date":"","week":"星期二","fchh":"11","cityid":"101010100",</span><br><span class="line">        #6天温度范围</span><br><span class="line">        "temp1":"22℃~11℃","temp2":"25℃~11℃","temp3":"26℃~13℃","temp4":"25℃~15℃","temp5":"25℃~16℃","temp6":"24℃~16℃",</span><br><span class="line">        #6天温度范围（华氏）</span><br><span class="line">        "tempF1":"71.6℉~51.8℉","tempF2":"77℉~51.8℉","tempF3":"78.8℉~55.4℉","tempF4":"77℉~59℉","tempF5":"77℉~60.8℉","tempF6":"75.2℉~60.8℉",</span><br><span class="line">        #6天天气</span><br><span class="line">        "weather1":"多云转晴","weather2":"晴","weather3":"晴","weather4":"晴转多云","weather5":"阴转阵雨","weather6":"多云",</span><br><span class="line">        #6天天气图示（每天2张）</span><br><span class="line">        "img1":"1","img2":"0","img3":"0","img4":"99","img5":"0","img6":"99","img7":"0","img8":"1","img9":"2","img10":"3","img11":"1","img12":"99",</span><br><span class="line">        "img_single":"1",</span><br><span class="line">        #6天天气图示文字（每天2）</span><br><span class="line">        "img_title1":"多","img_title2":"晴","img_title3":"晴","img_title4":"晴","img_title5":"晴","img_title6":"晴","img_title7":"晴","img_title8":"多云","img_title9":"阴","img_title10":"阵雨","img_title11":"多云","img_title12":"多云",</span><br><span class="line">        "img_title_single":"多云",</span><br><span class="line">        #6天风</span><br><span class="line">        "wind1":"北风3-4级转微风","wind2":"微风","wind3":"微风","wind4":"微风","wind5":"微风","wind6":"微风",</span><br><span class="line">        "fx1":"北风","fx2":"微风",</span><br><span class="line">        #6天风力情况</span><br><span class="line">        "fl1":"3-4级转小于3级","fl2":"小于3级","fl3":"小于3级","fl4":"小于3级","fl5":"小于3级","fl6":"小于3级",</span><br><span class="line">        #24小时内</span><br><span class="line">        "index":"较冷","index_d":"建议着大衣、呢外套加毛衣、卫衣等服装。体弱者宜着厚外套、厚毛衣。因昼夜温差较大，注意增减衣服。",</span><br><span class="line">        #48小时内</span><br><span class="line">        "index48":"较舒适","index48_d":"建议着薄外套或牛仔衫裤等服装。年老体弱者宜着夹克衫、薄毛衣等。昼夜温差较大，注意适当增减衣服。",</span><br><span class="line">        #紫外 洗车 旅游 舒适指数 晨练 晾晒 过敏</span><br><span class="line">        "index_uv":"弱",</span><br><span class="line">        "index48_uv":"强",</span><br><span class="line">        "index_xc":"适宜",</span><br><span class="line">        "index_tr":"适宜",</span><br><span class="line">        "index_co":"舒",</span><br><span class="line">        "st1":"21","st2":"12","st3":"24","st4":"12","st5":"25","st6":"14", #不明</span><br><span class="line">        "index_cl":"较适宜",</span><br><span class="line">        "index_ls":"适宜",</span><br><span class="line">        "index_ag":"极易发"</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure></li></ul><p>####3. 相应图片信息接口<br>不同天气对应不同图片，每天两张图片对应白天和晚上天气，下面以晴天为例演示几种可用的图片类型。 </p><p>来自weather.com.cn的图片：<br>20x20：<a href="http://m.weather.com.cn/img/c0.gif" target="_blank" rel="noopener">http://m.weather.com.cn/img/c0.gif</a><br>50x46：<a href="http://m.weather.com.cn/img/b0.gif" target="_blank" rel="noopener">http://m.weather.com.cn/img/b0.gif</a><br>29x20：<a href="http://www.weather.com.cn/m/i/weatherpic/29x20/d0.gif" target="_blank" rel="noopener">http://www.weather.com.cn/m/i/weatherpic/29x20/d0.gif</a>    #白天带黄色背景<br>29x20：<a href="http://www.weather.com.cn/m2/i/icon_weather/29x20/n00.gif" target="_blank" rel="noopener">http://www.weather.com.cn/m2/i/icon_weather/29x20/n00.gif</a> #夜间带深色背景<br>城市LOGO：<a href="http://poster.weather.com.cn/p_files/base/101020100.jpg" target="_blank" rel="noopener">http://poster.weather.com.cn/p_files/base/101020100.jpg</a></p><p>c打头的图片是20<em>20像素的，b打头的是50</em>46像素的，d打头的是反白的图标，29<em>20像素，n打头的是夜间反白图标，29</em>20像素，注意这里的文件名是两位数字！</p><p>来自mobile.weather.com的图片(图片看起来更美观）)：<br>晴天：<a href="http://mobile.weather.com.cn/images/day/00.png" target="_blank" rel="noopener">http://mobile.weather.com.cn/images/day/00.png</a><br>多云：<a href="http://mobile.weather.com.cn/images/day/01.png" target="_blank" rel="noopener">http://mobile.weather.com.cn/images/day/01.png</a><br>多云晚上： <a href="http://mobile.weather.com.cn/images/night/01.png" target="_blank" rel="noopener">http://mobile.weather.com.cn/images/night/01.png</a><br>下雨：<a href="http://mobile.weather.com.cn/images/day/07.png" target="_blank" rel="noopener">http://mobile.weather.com.cn/images/day/07.png</a><br>阴天：<a href="http://mobile.weather.com.cn/images/day/02.png" target="_blank" rel="noopener">http://mobile.weather.com.cn/images/day/02.png</a>   </p><p>####4. 其他数据获取接口<br>天气资讯数据： <a href="http://mobile.weather.com.cn/data/news/khdjson.htm?_=1381891660018" target="_blank" rel="noopener">http://mobile.weather.com.cn/data/news/khdjson.htm?_=1381891660018</a><br>室外活动指数数据：<a href="http://mobile.weather.com.cn/data/zsM/101010100.html?_=1381891661502" target="_blank" rel="noopener">http://mobile.weather.com.cn/data/zsM/101010100.html?_=1381891661502</a><br>3H预测数据接口： <a href="http://mobile.weather.com.cn/data/forecast3h/101010100.html?_=1381891661605" target="_blank" rel="noopener">http://mobile.weather.com.cn/data/forecast3h/101010100.html?_=1381891661605</a> </p><p>如有特殊天气发生，通过预警接口可获取预警数据，详细如下：<br>特殊天气预警接口：<a href="http://product.weather.com.cn/alarm/stationalarm.php?areaid=101190401&amp;count=-1&amp;_=1381894097508" target="_blank" rel="noopener">http://product.weather.com.cn/alarm/stationalarm.php?areaid=101190401&amp;count=-1&amp;_=1381894097508</a><br>信息格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var alarminfo=&#123;&quot;count&quot;:&quot;25&quot;,&quot;data&quot;:[[&quot;江苏省&quot;,&quot;**10119-20131204220706-1203.html**&quot;]]&#125;;</span><br></pre></td></tr></table></figure></p><p>预警内容获取：<a href="http://www.weather.com.cn/data/alarm/10119-20131204220706-1203.html" target="_blank" rel="noopener">http://www.weather.com.cn/data/alarm/10119-20131204220706-1203.html</a><br>预警信息页面：<a href="http://mobile.weather.com.cn/yj_content.html?file=10119-20131204220706-1203.html" target="_blank" rel="noopener">http://mobile.weather.com.cn/yj_content.html?file=10119-20131204220706-1203.html</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var alarminfo=&#123;</span><br><span class="line">    &quot;ALERTID&quot;:&quot;201312042208582381大雾橙色&quot;,</span><br><span class="line">    &quot;PROVINCE&quot;:&quot;江苏省&quot;,</span><br><span class="line">    &quot;CITY&quot;:&quot;&quot;,&quot;STATIONNAME&quot;:&quot;&quot;,</span><br><span class="line">    &quot;SIGNALTYPE&quot;:&quot;大雾&quot;,</span><br><span class="line">    &quot;SIGNALLEVEL&quot;:&quot;橙色&quot;,</span><br><span class="line">    &quot;ISSUETIME&quot;:&quot;2013-12-04 22:07:06&quot;,</span><br><span class="line">    &quot;ISSUECONTENT&quot;:&quot;江苏省气象台13年12月4日21时57分发布大雾橙色预警信号。目前淮安、盐城、南通、扬州和泰州的大部分地区已经出现能见度小于200米的雾并将持续，另外预计未来12小时内徐州、连云港、宿迁、南京、镇江、常州、无锡和苏州的大部分地区将出现能见度小于1000米、大于等于200米的雾。&quot;,</span><br><span class="line">    &quot;UNDERWRITER&quot;:&quot;魏建苏&quot;,</span><br><span class="line">    &quot;RELIEVETIME&quot;:&quot;2013-12-05 22:07:06&quot;&#125;</span><br></pre></td></tr></table></figure></p><p>####5. 获取全国所有城市代码列表<br><strong>方法一</strong><br>XML接口根节点： <a href="http://flash.weather.com.cn/wmaps/xml/china.xml" target="_blank" rel="noopener">http://flash.weather.com.cn/wmaps/xml/china.xml</a><br>XML接口主要作用是递归获取全国几千个县以上单位的城市代码，如：<br>江苏的XML地址为：<a href="http://flash.weather.com.cn/wmaps/xml/shanghai.xml" target="_blank" rel="noopener">http://flash.weather.com.cn/wmaps/xml/shanghai.xml</a><br>苏州的XML地址为：<a href="http://flash.weather.com.cn/wmaps/xml/jiangsu.xml" target="_blank" rel="noopener">http://flash.weather.com.cn/wmaps/xml/jiangsu.xml</a><br>上面页面获得太仓city code：101190408<br>合成太仓天气信息地址：<a href="http://m.weather.com.cn/data/101190408.html" target="_blank" rel="noopener">http://m.weather.com.cn/data/101190408.html</a></p><p>下面贴一段<a href="https://github.com/jsjwolf/good_utils/blob/master/getAllCityCode4Weather_com.php" target="_blank" rel="noopener">PHP代码</a>实现的，通过XML接口根节点递归获得全国几千个县以上城市cide code的代码，供参考(可直接在终端下运行）：</p><p><strong>方法二</strong><br>更新：最新发现可以一次性获取全国+国外主要城市，8763个城市列表信息。<br>URL：<a href="http://mobile.weather.com.cn/js/citylist.xml" target="_blank" rel="noopener">http://mobile.weather.com.cn/js/citylist.xml</a>  </p><p>###Yahoo天气预报接口<br>URL: <a href="http://weather.yahooapis.com/forecastrss?w=2151330&amp;u=c" target="_blank" rel="noopener">http://weather.yahooapis.com/forecastrss?w=2151330&amp;u=c</a><br>该接口没有测试。</p><p>##二 环境指数接口<br>最近大半个中国发生的严重雾霾天气，震惊了我们的老百姓，PM2.5指数概念深入人心。目前有两个接口推荐：  </p><ul><li>pm25.in，需要申请KEY,次数有限制，数据内容丰富，格式清楚；</li><li>国家气象局，无需KEY，且次数无限制，数据内容简单，无PM10数据。</li></ul><h3 id="pm25-in-PM10-PM2-5数值查询接口"><a href="#pm25-in-PM10-PM2-5数值查询接口" class="headerlink" title="pm25.in PM10/PM2.5数值查询接口"></a>pm25.in PM10/PM2.5数值查询接口</h3><p><a href="pm25.in：http://www.pm25.in/api_doc">pm25.in主页</a>，pm25.in是一家第三方提供pm2.5/pm10环境数据的网站，数据来源于中国国家环境监测中心，其接口使用需要申请KEY（具体请参考其官方网站）。  </p><p>PM10调用：<a href="http://www.pm25.in/api/querys/pm10.json?city=%E4%B8%8A%E6%B5%B7&amp;token=5j1znBVAsnSf5xQyNQyq&amp;avg" target="_blank" rel="noopener">http://www.pm25.in/api/querys/pm10.json?city=%E4%B8%8A%E6%B5%B7&amp;token=5j1znBVAsnSf5xQyNQyq&amp;avg</a>(该链接中的Key仅供测试用，请自行申请）<br>数据格式如下：（<strong>最后一行为所有检测点平均值</strong>）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">&#123;&quot;aqi&quot;:147,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:180,&quot;pm10_24h&quot;:167,&quot;position_name&quot;:&quot;普陀&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:&quot;1141A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:163,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:151,&quot;pm10_24h&quot;:156,&quot;position_name&quot;:&quot;十五厂&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1142A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:150,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:0,&quot;pm10_24h&quot;:0,&quot;position_name&quot;:&quot;虹口&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:&quot;1143A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:170,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:0,&quot;pm10_24h&quot;:0,&quot;position_name&quot;:&quot;徐汇上师大&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1144A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:0,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:0,&quot;pm10_24h&quot;:0,&quot;position_name&quot;:&quot;杨浦四漂&quot;,&quot;primary_pollutant&quot;:null,&quot;quality&quot;:null,&quot;station_code&quot;:&quot;1145A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:79,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:115,&quot;pm10_24h&quot;:108,&quot;position_name&quot;:&quot;青浦淀山湖&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM10)&quot;,&quot;quality&quot;:&quot;良&quot;,&quot;station_code&quot;:&quot;1146A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:160,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:0,&quot;pm10_24h&quot;:121,&quot;position_name&quot;:&quot;静安监测站&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1147A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:150,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:198,&quot;pm10_24h&quot;:135,&quot;position_name&quot;:&quot;浦东川沙&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:&quot;1148A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:152,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:152,&quot;pm10_24h&quot;:150,&quot;position_name&quot;:&quot;浦东新区监测站&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1149A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:0,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:0,&quot;pm10_24h&quot;:0,&quot;position_name&quot;:&quot;浦东张江&quot;,&quot;primary_pollutant&quot;:null,&quot;quality&quot;:null,&quot;station_code&quot;:&quot;1150A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:146,&quot;area&quot;:&quot;上海&quot;,&quot;pm10&quot;:159,&quot;pm10_24h&quot;:139,&quot;position_name&quot;:null,&quot;primary_pollutant&quot;:null,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:null,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p><p>PM2.5调用：<a href="http://www.pm25.in/api/querys/pm2_5.json?city=%E4%B8%8A%E6%B5%B7&amp;token=5j1znBVAsnSf5xQyNQyq&amp;avg" target="_blank" rel="noopener">http://www.pm25.in/api/querys/pm2_5.json?city=%E4%B8%8A%E6%B5%B7&amp;token=5j1znBVAsnSf5xQyNQyq&amp;avg</a><strong>(该链接中的Key仅供测试用，请自行申请）</strong><br>数据格式如下：（<strong>最后一行为所有检测点平均值</strong>）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">&#123;&quot;aqi&quot;:147,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:105,&quot;pm2_5_24h&quot;:112,&quot;position_name&quot;:&quot;普陀&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:&quot;1141A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:163,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:129,&quot;pm2_5_24h&quot;:124,&quot;position_name&quot;:&quot;十五厂&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1142A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:150,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:124,&quot;pm2_5_24h&quot;:115,&quot;position_name&quot;:&quot;虹口&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:&quot;1143A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:170,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:141,&quot;pm2_5_24h&quot;:129,&quot;position_name&quot;:&quot;徐汇上师大&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1144A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:0,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:0,&quot;pm2_5_24h&quot;:0,&quot;position_name&quot;:&quot;杨浦四漂&quot;,&quot;primary_pollutant&quot;:null,&quot;quality&quot;:null,&quot;station_code&quot;:&quot;1145A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:79,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:0,&quot;pm2_5_24h&quot;:0,&quot;position_name&quot;:&quot;青浦淀山湖&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM10)&quot;,&quot;quality&quot;:&quot;良&quot;,&quot;station_code&quot;:&quot;1146A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:160,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:103,&quot;pm2_5_24h&quot;:122,&quot;position_name&quot;:&quot;静安监测站&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1147A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:150,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:163,&quot;pm2_5_24h&quot;:115,&quot;position_name&quot;:&quot;浦东川沙&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:&quot;1148A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:152,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:127,&quot;pm2_5_24h&quot;:116,&quot;position_name&quot;:&quot;浦东新区监测站&quot;,&quot;primary_pollutant&quot;:&quot;颗粒物(PM2.5)&quot;,&quot;quality&quot;:&quot;中度污染&quot;,&quot;station_code&quot;:&quot;1149A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:0,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:0,&quot;pm2_5_24h&quot;:0,&quot;position_name&quot;:&quot;浦东张江&quot;,&quot;primary_pollutant&quot;:null,&quot;quality&quot;:null,&quot;station_code&quot;:&quot;1150A&quot;,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;,</span><br><span class="line">&#123;&quot;aqi&quot;:146,&quot;area&quot;:&quot;上海&quot;,&quot;pm2_5&quot;:127,&quot;pm2_5_24h&quot;:119,&quot;position_name&quot;:null,&quot;primary_pollutant&quot;:null,&quot;quality&quot;:&quot;轻度污染&quot;,&quot;station_code&quot;:null,&quot;time_point&quot;:&quot;2013-12-04T19:00:00Z&quot;&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p><p><strong>注意: 部分城市可能没有pm2.5/pm10数据；</strong>  </p><h3 id="气象局接口PM2-5数值查询接口"><a href="#气象局接口PM2-5数值查询接口" class="headerlink" title="气象局接口PM2.5数值查询接口"></a>气象局接口PM2.5数值查询接口</h3><p>气象局接口目前提供PM2.5和AQI数据查询，暂没有发现PM10查询接口。该接口目前不需要申请KEY，可以直接使用。    </p><p>接口：<a href="http://mobile.weather.com.cn/data/air/101190401.html?_=1386217771438" target="_blank" rel="noopener">http://mobile.weather.com.cn/data/air/101190401.html?_=1386217771438</a><br>页面：<a href="http://mobile.weather.com.cn/air/101190401.html" target="_blank" rel="noopener">http://mobile.weather.com.cn/air/101190401.html</a>  </p><p>格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;k&quot;:&#123;&quot;</span><br><span class="line">    k1&quot;:&quot;?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?|?&quot;,</span><br><span class="line">    &quot;k2&quot;:&quot;246|239|156|?|114|114|105|105|119|139|290|300|178|178|193|217|217|217|217|217|217|217|217|217|217&quot;,</span><br><span class="line">    &quot;k3&quot;:&quot;296|289|206|?|148|148|137|137|155|315|340|368|228|228|243|267|267|267|267|267|267|267|267|267|267&quot;,</span><br><span class="line">    &quot;k4&quot;:&quot;201312051100&quot;&#125;&#125;</span><br><span class="line"></span><br><span class="line">解析方法如下：</span><br><span class="line">```  </span><br><span class="line">$pm2d5Str = result.k.k2; </span><br><span class="line">$pm2d5Arr = result.k.k3.split(&quot;|&quot;); </span><br><span class="line">$pm2d5 = $pm2d5Arr[23];</span><br><span class="line"> </span><br><span class="line">$aqiStr=result.k.k3;  </span><br><span class="line">$aqiArr=result.k.k3.split(&quot;|&quot;);  </span><br><span class="line">$aqi = $aqiArr[23];</span><br><span class="line"></span><br><span class="line">$publish_date=result.k.k4;</span><br></pre></td></tr></table></figure></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li>参考github代码：<a href="https://github.com/hxxy2003/Weather-weixin/blob/master/index.php" target="_blank" rel="noopener">https://github.com/hxxy2003/Weather-weixin/blob/master/index.php</a></li><li>一份详细解读参考：<a href="http://g.kehou.com/t1033317914.html" target="_blank" rel="noopener">http://g.kehou.com/t1033317914.html</a></li><li>PM参考：<a href="http://malagis.com/recommended-air-quality-data-pm10-pm2-5.html" target="_blank" rel="noopener">http://malagis.com/recommended-air-quality-data-pm10-pm2-5.html</a>  </li></ul><p>全文完（2013-12-31）</p><hr><p><img align="middle" alt="随手查查" src="/images/about/suishou_WX.jpg" width="300"></p><p>关注『<strong>随手查查</strong>』微信公号，支持以图搜图、天气预报、百科和火车票等信息查询。  </p><hr>]]></content>
    
    <summary type="html">
    
      因微信公共号提供城市天气预报服务，发现网山天气预报接口和环境数据接口方面资料比较乱，而且有不少内容已经失效，下面内容由过程日志整理形成，希望有人可用得上。
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="API" scheme="http://goodbai.com/tags/API/"/>
    
      <category term="天气预报" scheme="http://goodbai.com/tags/%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>利用BAE搭建Goagent代理服务突破内网封锁</title>
    <link href="http://goodbai.com/2013/12/24/UseGoagentCrossLan/"/>
    <id>http://goodbai.com/2013/12/24/UseGoagentCrossLan/</id>
    <published>2013-12-23T16:00:00.000Z</published>
    <updated>2018-03-24T05:03:04.435Z</updated>
    
    <content type="html"><![CDATA[<p>上网行为管理实现方法很多，但基本原理是在网关处增加包过滤机制，根据域名/IP、端口、协议等来确定是否允许访问通过，了解了这个突破封锁就好办，我们要：  </p><ul><li>隐藏真实访问地址；   </li><li>改变连接端口和转换包协议（或者使用SSL加密）； </li></ul><p>理解了上面这段话，下来就简单了。我们需要搭一个代理服务器，所有被封锁的网站都通过代理访问，代理服务器与本地间使用加密方式通信，这样只要代理服务器可以访问，所有网站就都可以访问，实现这个目标具体三个步骤：</p><ol><li>寻找一个可托管php/python代码的服务器资源（BAE-百度云）；  </li><li>配置代理程序(Goagent)：<ul><li>上传代理程序的服务端代码，启用服务端程序；  </li><li>配置代理程序的客户端，运行客户端程序；  </li></ul></li><li>配置浏览器代理，完成。  </li></ol><p>##第一步：建立BAE应用<br><a href="http://developer.baidu.com/bae/" target="_blank" rel="noopener">BAE（Baidu App Engine）</a>,百度网络应用开发平台，当今云计算如火如荼，此属于<a href="http://zh.wikipedia.org/wiki/%E5%B9%B3%E5%8F%B0%E5%8D%B3%E6%9C%8D%E5%8A%A1" target="_blank" rel="noopener">PaaS</a>（Platform as a Service，全称平台即服务）一类，选择BAE因为两点，一支持php/python，二每天提供200M免费流量，详细参考官方文档。</p><p>建立BAE应用流程：</p><ol><li>进入<a href="http://developer.baidu.com/bae" target="_blank" rel="noopener">注册页面</a>注册帐号；  </li><li>收取激活邮件，点击激活链接激活并完善BAE开发者帐号信息；  </li><li>建立BAE应用：通过 管理控制台 &gt; 创建应用（假设名为goodProxy)，完成后保存；    </li><li>添加部署：进入刚建立应用的管理主页，点击左边栏的“应用引擎”添加部署（类型选php-web，域名这里假设为goodproxy.duapp.com）；  </li><li>记录该部署应用的仓库同步地址（git/svn)，后面要向该地址上传代理程序服务器端的代码。  </li></ol><p>##第二步：配置Goagent代理<br><a href="https://code.google.com/p/goagent/" target="_blank" rel="noopener">Goagent</a>，一款大名鼎鼎的上网代理软件。</p><p>Goagent由服务端和客户端两部分组成：  </p><ul><li>服务端有php和python两种实现，必须工作在被封锁的网络之外（这个事不能太细说，自己体会）；  </li><li>客户端用python实现，支持Linux/MAC OS X/Windows系统，运行在本地计算机（又叫你的电脑）。  </li></ul><p>goagent-v3.1.1-35目前最新发布的稳定版，<a href="https://nodeload.github.com/goagent/goagent/legacy.zip/3.0" target="_blank" rel="noopener">下载地址</a>(地址在墙外，请自行想办法)，该版本配置流程如下。</p><p>###1. 解压程序包<br>解压goagent-goagent-v3.1.1-35-g0cb031b.zip，目录结构：</p><pre><code>$ tree goagent-v3.1.1-35/ -L 1goagent-v3.1.1-35/├── local    ├── README.md└── server</code></pre><p>###2. 上传goagent服务端代码<br>本文推荐上传php版（即goagent-v3.1.1-35/server/php/index.php），上传地址从“建立BAE应用流程”第五步中获得；BAE支持两种方式上传代码：打包上传和git/SVN上传，根据情况选择上传方式。默认的代码有BUG，解决方法请查看本文最后的注意。 </p><p>###3. 配置goagent本地端<br>修改配置文件”goagent-v3.1.1-35/local/proxy.ini”，使PHP一节的内容如下(<strong>fetchserver的值请从“建立BAE应用流程”第四步中获得</strong>)：  </p><pre><code>[php]enable = 1password = 123456crlf = 0validate = 0listen = 127.0.0.1:8088fetchserver = **http://xxxx.duapp.com/index.php**usehosts = 1</code></pre><p>###4. 运行goagent本地客户端<br>Linux系统下运行方法：</p><pre><code>sudo python goagent-v3.1.1-35/local/proxy.py    </code></pre><p>Windows直接双击运行：goagent-v3.1.1-35/local/goagent.exe，成功运行类似如下输出：</p><pre><code>------------------------------------------------------GoAgent Version    : v3.1.1 (python/2.7.3 pyopenssl/0.12)Listen Address     : 127.0.0.1:8087Debug INFO         : 1GAE Mode           : httpsGAE Profile        : google_hkGAE APPID          : xxxxxxxPac Server         : http://127.0.0.1:8086/proxy.pacPac File           : file:///home/good/goagent-v3.0.8-61/local/proxy.pac**PAAS Listen        : 127.0.0.1:8088****PAAS FetchServer   : http://xxxxx.duapp.com/index.php**------------------------------------------------------</code></pre><p>##第三步：配置浏览器代理<br>代理地址为：127.0.0.1:8088，可以通过直接配置浏览器代理使用，也可通过浏览器插件来使用代理，插件可根据访问的地址智能判断是否需要代理。  </p><p>访问[站长之家] (<a href="http://ip.chinaz.com/)，如果地址显示北京，祝贺你！" target="_blank" rel="noopener">http://ip.chinaz.com/)，如果地址显示北京，祝贺你！</a></p><p>Chrome浏览器推荐使用 <a href="https://chrome.google.com/webstore/detail/dpplabbmogkhghncfbfdeeokoefdjegm" target="_blank" rel="noopener">SwitchySharp</a>插件,然后导入 local/SwitchyOptions.bak 设置<br>firefox浏览器推荐使用 FoxyProxy 插件<br>IE/Opera及其他 用户请使用 IE 代理。</p><p>##补充几点</p><ol><li>goagent本地与代理服务器之间连接使用弱加密，尤其是https，在涉及网银密码等信息时，谨防泄漏密码。    </li><li><p>默认的Goagent代理服务器端php代码有缺陷，要在最后加上一行：</p> <pre><code>?></code></pre></li></ol><p>##更新2014-07-29<br>打开部分网站时报错：error xxx （Too many open files’）<br>原因是Linux默认进程打开文件数限制太小的原因，我的调到4096后问题解决，参考命令：</p><pre><code>$ ulimit -n 4096</code></pre><p>##参考<br>详细参考：<a href="https://code.google.com/p/goagent/" target="_blank" rel="noopener">https://code.google.com/p/goagent/</a><br>FAQ：<a href="https://code.google.com/p/goagent/wiki/FAQ" target="_blank" rel="noopener">https://code.google.com/p/goagent/wiki/FAQ</a>  </p><p>全文完<br>2013-12-24</p>]]></content>
    
    <summary type="html">
    
      前阵子微博上看到一句话：“他们不知道内网开发的痛苦”，深表同情。许多企业内部通过&lt;b&gt;上网行为管理系统&lt;/b&gt;限制访问部分网站，比如像[Ubutnu中文论坛]也在某公司禁止之列，作为一名geek怎可忍受！
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="BAE" scheme="http://goodbai.com/tags/BAE/"/>
    
      <category term="代理" scheme="http://goodbai.com/tags/%E4%BB%A3%E7%90%86/"/>
    
      <category term="科学上网" scheme="http://goodbai.com/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
  </entry>
  
  <entry>
    <title>利用BAE搭建微信公号“小秘书”后台服务</title>
    <link href="http://goodbai.com/2013/09/18/UseBAEBuildWXService/"/>
    <id>http://goodbai.com/2013/09/18/UseBAEBuildWXService/</id>
    <published>2013-09-17T16:00:00.000Z</published>
    <updated>2018-03-24T05:02:04.040Z</updated>
    
    <content type="html"><![CDATA[<p>##BAE搭建微信公共号</p><p>搭建mp.weixin认证服务参考：<a href="http://blog.sina.com.cn/s/blog_73b905910101a3xk.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_73b905910101a3xk.html</a><br>参照上面执行，微信开发者认证，下一步开启消息推送服务。默认的demo修改如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//$wechatObj-&gt;valid();</span><br><span class="line">$wechatObj-&gt;responseMsg();</span><br></pre></td></tr></table></figure><p>这时，给公众号发生任意非空内容，将收到回复“Welcome to wechat world!”。如果还是没有收到，或许是你开启了“编辑模式”。</p><p>##BAE 搭建微信公号自动响应服务<br>计费策略：<a href="http://developer.baidu.com/wiki/index.php?title=docs/cplat/billing" target="_blank" rel="noopener">http://developer.baidu.com/wiki/index.php?title=docs/cplat/billing</a></p><p>##增加翻译功能</p><p>###Build 翻译<br><a href="http://www.cnblogs.com/mchina/p/3170565.html" target="_blank" rel="noopener">http://www.cnblogs.com/mchina/p/3170565.html</a><br>baidu翻译文档：<a href="http://developer.baidu.com/wiki/index.php?title=帮助文档首页/百度翻译/翻译API" target="_blank" rel="noopener">http://developer.baidu.com/wiki/index.php?title=帮助文档首页/百度翻译/翻译API</a></p><p>###youdao 翻译<br><a href="http://fanyi.youdao.com/openapi?path=data-mode" target="_blank" rel="noopener">http://fanyi.youdao.com/openapi?path=data-mode</a></p><p>##参考<br>google search (天气预报 上海 api) <a href="http://www.google.com.hk/search?newwindow=1&amp;safe=strict&amp;client=safari&amp;rls=en&amp;q=%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5+%E4%B8%8A%E6%B5%B7+api&amp;oq=%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5+%E4%B8%8A%E6%B5%B7+api&amp;gs_l=serp.12...0.0.0.83631886.0.0.0.0.0.0.0.0..0.0....0...1c..26.serp..0.0.0.RRVw2C1mR_w" target="_blank" rel="noopener">http://www.google.com.hk/search?newwindow=1&amp;safe=strict&amp;client=safari&amp;rls=en&amp;q=%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5+%E4%B8%8A%E6%B5%B7+api&amp;oq=%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5+%E4%B8%8A%E6%B5%B7+api&amp;gs_l=serp.12...0.0.0.83631886.0.0.0.0.0.0.0.0..0.0....0...1c..26.serp..0.0.0.RRVw2C1mR_w</a></p><p><a href="http://www.weather.com.cn/data/cityinfo/101010100.html" target="_blank" rel="noopener">Beijing</a><br><a href="http://www.weather.com.cn/data/cityinfo/101190401.html" target="_blank" rel="noopener">Suzhou</a></p><p>##backup<br>有道翻译API申请成功<br>API key：2122702772<br>keyfrom：goodbaiA<br>创建时间：2013-09-15<br>网站名称：goodbaiA<br>网站地址：<a href="http://goodbai.duapp.com" target="_blank" rel="noopener">http://goodbai.duapp.com</a></p>]]></content>
    
    <summary type="html">
    
      当你在公司、在家里抑或咖啡馆连上了一个免费AP，享受互联网冲浪无比畅快的同时，背后可能正有双眼睛在监视着，MM们正在臭美的QQ空间，GG们正浏览的&quot;照片&quot;，甚至是银行卡等帐号信息...这到底是怎么回事？
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="BAE" scheme="http://goodbai.com/tags/BAE/"/>
    
      <category term="微信公众号" scheme="http://goodbai.com/tags/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
  </entry>
  
  <entry>
    <title>谁动了你的系统：Linux系统安全体检</title>
    <link href="http://goodbai.com/2013/08/15/WhoMovedYourLinuxOS/"/>
    <id>http://goodbai.com/2013/08/15/WhoMovedYourLinuxOS/</id>
    <published>2013-08-14T16:00:00.000Z</published>
    <updated>2018-03-24T05:04:42.247Z</updated>
    
    <content type="html"><![CDATA[<p>本文内容主要是多年使用Linux过程中，个人的一些积累，这里记录下来，与大家共同学习。文中以Ubuntu-12.10系统举例，但同样适用于其他主流Linux发行版。本文不涉及Intrusion Detection Systems(IDS,入侵检测系统）知识。</p><h2 id="常规检查"><a href="#常规检查" class="headerlink" title="常规检查"></a>常规检查</h2><p>系统版本信息</p><pre><code>$ lsb_release -aLSB Version:    core-2.0-ia32:core-2.0-noarch:core-3.core...Distributor ID:    UbuntuDescription:    Ubuntu 12.10Release:    12.10Codename:    quantal</code></pre><p>系统安装软件包列表</p><pre><code>$ rpm -qa                  #Fedora/Redhat系统适用$ dpkg -l                  #Ubuntu系统适用</code></pre><p>系统进程运行状态</p><pre><code>$ top1 top - 15:34:24 up 23:44, 10 users,  load average: 0.52, 0.56, 0.592 Tasks: 245 total,   2 running, 241 sleeping,   1 stopped,   1 zombie3 %Cpu(s): 14.3 us,  3.4 sy,  0.0 ni, 82.0 id,  0.0 wa,  0.0 hi,  0.3 si,  0.0 st4 KiB Mem:   3924136 total,  3220824 used,   703312 free,   296052 buffers5 KiB Swap:        0 total,        0 used,        0 free,  1488240 cached67   PID USER      PR  NI  VIRT  RES  SHR S  %CPU %MEM    TIME+  COMMAND8 14846 good      20   0  733m 158m  43m S  33.8  4.1  71:54.21 firefox9  1309 root      20   0 98.6m  29m 6616 S  14.6  0.8  39:01.19 Xorg10 ...</code></pre><p>说明：</p><ul><li>第1行，与命令w输出的含义相同</li><li>第2行，进程总数245 </li><li>第3行，CPU使用情况，用户态（us）占用率14.3%，内核态占用率3.4(sy) </li><li>第4,5行，内存使用情况，物理内存4G，空闲703M，交换分区大小为0 </li><li>第6,7,8行等，进程列表及实时运行状态 </li></ul><p>系统运行级查看</p><pre><code>$ runlevel </code></pre><p>Redhat/Fedora系统服务管理和配置</p><pre><code>$ chkconfig --list</code></pre><p>Redhat/Fedora系统也可以通过ntsysv命令在TUI界面配置服务</p><pre><code>$ ntsysv</code></pre><p>Ubuntu系统服务管理和配置实现特殊，所以Linux通用的服务管理命令chkconfig等不支持，<em>经初步试用发现命令update-rc.d还很初级，可能达不到预期效果</em>。</p><p>停止ssh服务</p><pre><code>$ sudo update-rc.d ssh disable</code></pre><p>启用ssh服务</p><pre><code>$ sudo update-rc.d ssh enable</code></pre><p>系统访问控制（selinux)，Fedora/Redhat系统Selinux状态查询方法如下(不适用Ubuntu，因没有预装selinux)。</p><pre><code>$ sudo getenforce</code></pre><h2 id="帐号安全"><a href="#帐号安全" class="headerlink" title="帐号安全"></a>帐号安全</h2><p>系统用户登陆情况检查</p><pre><code>$ w 15:09:17 up 23:18,  4 users,  load average: 0.77, 0.59, 0.63USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHATdemo     pts/2    192.168.1.100    15:12   1:16   0.30s  0.09s -bashgooo     tty7     :0               三15   23:18m 36:49   2.22s gnome-session --session=ubuntugooo     pts/0    :0               三15   23:57   9.24s  9.01s /usr/bin/firefox</code></pre><p>说明：</p><ul><li>系统当前时间：15:09:17</li><li>系统已运行时间：23:18</li><li>系统平均负载：0.77, 0.59, 0.63 （over the last 1, 5 and 15 minutes）</li><li>已登陆用户：4个<ul><li>demo用户通过网络在图形下的terminal(pts指虚拟终端）登陆，登陆时间15:12，IP地址为192.168.1.100；</li><li>gooo用户的第一个登陆在控制台七(即Ctrl+Alt+F5)，为当前gnome图形桌面的登陆用户；</li><li>gooo用户的第二个登陆在图形下的terminal，正在运行firefox; </li></ul></li></ul><p><em>注意</em>：如果发现有不明用户登陆系统，可通过命令”pkill -kill -t TTYName”将其踢掉，如踢掉demo用户的命令如下：</p><pre><code>$ sudo pkill -kill -t pts/2</code></pre><p>检查系统中保存帐号列表的文件中是否有异常帐号。</p><pre><code>$ cat /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/bin/shbin:x:2:2:bin:/bin:/bin/shsys:x:3:3:sys:/dev:/bin/shsync:x:4:65534:sync:/bin:/bin/sync...*test:x:0:1001:cs2c,,,,:/home/test:/bin/bash*</code></pre><p>要特别注意类似test(最后一行）的帐号，这个帐号UID被设为0，意味这个用户权限与root完全相同，而且在Ubuntu下可以直接登陆（Ubuntu下默认是不允许root登陆系统的），非常危险。</p><p>帐号历史活动记录</p><p>last命令显示系统最近三次用户登陆情况，如果不指定-n参数，默认显示所有。</p><pre><code>$ sudo last -n 3用户名    终端         来源                登录时间     - 关闭时间（持续时间）gooo     pts/2        192.168.1.100    Thu Aug 15 15:58 - 16:07  (00:08)    gooo     tty5                          Thu Aug 15 15:12 - 16:09  (00:57)gooo     pts/7        :0               Thu Aug 15 15:06   still logged in</code></pre><p>lastb命令显示系统最近三次用户登陆失败的情况，如果不指定-n参数，默认显示所有。ubuntu系统下lastb默认不记录通过远程ssh登陆的失败记录，问题还在查找。</p><pre><code>$ sudo lastb -n 3用户名    终端         来源                登录时间     - 关闭时间（持续时间）UNKNOWN  tty6                          Thu Aug 15 16:04 - 16:04  (00:00)    root     tty6                          Thu Aug 15 16:04 - 16:04  (00:00)    </code></pre><p>aureport是一个更加强大的系统审计信息查询工具，基于audit daemon，auditd根据配置规则记录相关系统活动，如用户口令修改记录、进程运行记录等信息，通过aureport工具可以查询audit日志。</p><pre><code>$ man aureport</code></pre><h2 id="网络安全"><a href="#网络安全" class="headerlink" title="网络安全"></a>网络安全</h2><p>服务端口开放检查</p><pre><code>$ sudo netstat -anpt1  Active Internet connections (servers and established)2  Proto Recv-Q Send-Q Local Address         Foreign Address       State       PID/Program name3  tcp        0      0 0.0.0.0:22            0.0.0.0:*             LISTEN      825/sshd        4  tcp        0      0 127.0.0.1:631         0.0.0.0:*             LISTEN      12489/cupsd     5  tcp        1      0 192.168.1.106:45268   91.189.92.11:443      CLOSE_WAIT  6  tcp        0      0 192.168.1.106:22      192.168.1.109:42066   ESTABLISHED 24652/sshd: 7  tcp        0      0 192.168.1.106:55095   192.168.1.108:22      ESTABLISHED 25221/ssh       8  tcp        0      0 192.168.1.106:32872   122.193.23.59:80      TIME_WAIT   -               9  tcp        0      0 192.168.1.106:46298   184.25.111.231:80     TIME_WAIT   -               10 udp        0      0 0.0.0.0:17500         0.0.0.0:*                         2579/drop11 tcp6       0      0 ::1:631               :::*                  LISTEN      12489/cupsd </code></pre><p>说明：</p><ul><li><p>命令说明(A)：</p><ul><li>“-a” 显示所有；</li><li>“-n” IP地址和端口号以数字方式显示，默认为别名方式；</li><li>“-p” 显示PID和进程名；</li><li>“-t” 显示TCP协议；</li><li>“-u” 显示UDP协议。</li></ul></li><li><p>第3行，<em>sshd服务(进程ID为825)开启了tcp协议的22号端口</em>，不限制接入IP地址；</p></li><li>第4行，cupsd服务开启了tcp协议的631端口，限制仅允许本地访问； </li><li>第5行，本机正在访问91.189.92.11的443端口；</li><li>第6行，<em>远程主机192.168.1.109</em>已经通过ssh服务远程登陆本机（192.168.1.106)；</li><li>第7行，本机已经通过ssh服务远程登陆远程主机192.168.1.109；</li><li>第8,9行，本机正在访问122.193.23.59和184.25.111.231两个网站；</li><li>第10行，<em>未知服务（drop进程，PID2579)</em>开启了udp协议的17500端口，不限制接入IP地址； </li><li>第11行，cupsd服务开启了tcp6协议(IPv6协议）的631端口，限制仅允许本地访问； </li></ul><p>下面是网络链路安全检查</p><p>默认网关检查</p><pre><code>$ route -n</code></pre><p>网络设备节点情况</p><pre><code>$ ifconfig -a</code></pre><p>实时网络连接状态和流量情况</p><pre><code>$ sudo iptstate -C</code></pre><p>ARP解析列表缓存显示。如果192.168.1.1是网关IP，而后面的MAC地址与实际不符，那应该是被ARP欺骗了！</p><pre><code>$ arp -a?  (192.168.1.1) at 00:23:9e:xx:xx:xx [ether] on eth0</code></pre><p>防火墙规则情况</p><pre><code>$ sudo iptables --list</code></pre><h2 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h2><p>如果有人入侵了你的系统，修改了系统启动脚本，还替换了一些关键程序来掩盖他的行踪，这该然后办？关键是你还不确定入侵是否发生过。<br>RPM包完整性校验</p><p>Redhat系列发行版（Fedora/RHEL）提供RPM包数据校验功能，通过文件签名值校验安装到系统中的软件包是否已经被篡改，也可以扫描出非官方发布的软件包。校验系统中所有软件包情况：</p><pre><code>$ rpm -Va </code></pre><p>校验指定指定软件包initscripts，扫描结果显示：initscripts包中的文件/etc/rc.d/rc.local与初始版本内容不一致。</p><pre><code>$ rpm -Va initscriptsS.5......  c /etc/rc.d/rc.local</code></pre><p>校验指定文件</p><pre><code>$ rpm -Vf /bin/netstat</code></pre><p>DEB包校验</p><p>Ubuntu系统默认不支持系统已安装包的完整性校验（个人结论），网上查到debsums这个包支持。</p><pre><code>$ sudo apt-get install debsums$ debsums  sysv-rc           #校验包sysv-rc$ debsums                    #校验系统中所有包</code></pre><h2 id="系统日志安全"><a href="#系统日志安全" class="headerlink" title="系统日志安全"></a>系统日志安全</h2><p>通过分析日志记录是查找系统安全隐患的重要手段，Linux系统下日志默认集中保存在目录/var/log下，下面主要列举几个主要的日志文件。</p><p>用户帐号认证日志，内容包括帐号登陆记录、权限转换（su/sudo)、修改口令等操作。</p><pre><code>$ sudo vim /var/log/secure   $ sudo vim /var/log/auth.log        #Ubuntu系统适用</code></pre><p>系统启动日志(即显示一行行OK的那个画面的内容)</p><pre><code>$ sudo vim /var/log/boot.log</code></pre><p>内核启动初始化日志</p><pre><code>$ sudo vim /var/log/dmesg</code></pre><p>系统服务和核心组件日志（如networkmanager/gnome-session等）</p><pre><code>$ sudo vim /var/log/messages$ sudo vim /var/log/syslog          #Ubuntu系统适用</code></pre><p>Xorg图形系统日志</p><pre><code>$ sudo vim /var/log/Xorg.0.log</code></pre><p>在线软件包操作日志，内容包括install/remove/update等记录。</p><pre><code>$ sudo vim /var/log/yum.log          #Fedora/Redhat系统适用$ sudo vim /var/log/apt.log          #Ubuntu系统适用</code></pre><p>全文完。</p>]]></content>
    
    <summary type="html">
    
      通过定期体检可以发现身体潜藏的疾病，可能操作系统也一样，如果能定期对Linux系统做安全检查，可以使你的系统更加牢固。系统开放了那些端口(服务），是那个程序开的？是否遭受入侵或者攻击？我们下来看看。
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="安全" scheme="http://goodbai.com/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="linux" scheme="http://goodbai.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>局域网安全为何如此不堪：演习一次内网攻击</title>
    <link href="http://goodbai.com/2013/08/05/WhyLANSoInsecure/"/>
    <id>http://goodbai.com/2013/08/05/WhyLANSoInsecure/</id>
    <published>2013-08-04T16:00:00.000Z</published>
    <updated>2018-03-24T05:29:52.835Z</updated>
    
    <content type="html"><![CDATA[<p>准备该文一段时间了，作为新博客上第一篇文章，甚是费心，待各种小伎俩融汇贯通，才敢来卖弄。如熟悉TCP/IP协议族，则阅读本文比较轻松，如不然则也无大恙，毕竟本文只是笼统介绍局域网安全。</p><h2 id="局域网安全为何如此不堪"><a href="#局域网安全为何如此不堪" class="headerlink" title="局域网安全为何如此不堪"></a>局域网安全为何如此不堪</h2><p>首先作几个定义，什么是局域网，什么是地址解析协议，什么是网络安全，下面是个人的理解。</p><p>###局域网的缺陷<br>局域网简称LAN（Local Area Network），对应OSI七层模型的三层以下（一般不含第三层IP层)，两层交换机或者共享式集线器组网，该类设备一般不具有基于IP地址的路由功能，故局域网内各节点间通过MAC地址（网卡物理地址）标识和通信，而MAC地址是由各个节点自行维护，这意味着我说我是谁我就是谁，这可能是局域网脆弱的根本因素。</p><h3 id="脆弱的地址解析协议"><a href="#脆弱的地址解析协议" class="headerlink" title="脆弱的地址解析协议"></a>脆弱的地址解析协议</h3><p>地址解析协议之于网络通信，相当于信号灯系统之于公路交通，是用来指示目标和方向的，此一旦混乱，后果可想而知，事实上呢？</p><ul><li><p>地址解析协议(ARP)，ARP(Address Resolution Protocol)，当内网节点间（或者是节点与网关间）需要通信时，ARP解析获得目标IP地址对应的MAC地址，通过该MAC地址完成数据包发送。ARP协议是局域网通信的基础，ARP协议是这样工作的：如主机B需要给主机A（IP为192.168.1.100)发送数据，为了知道谁是主机A，首先主机B发送一个广播包给网内所有机器“谁是192.168.1.10”，正常情况其他机器忽略该消息，仅主机A回复“俺就是192.168.1.10”，于是通信就可以开始。至于不正常情况就是本文的主题。</p></li><li><p>域名解析系统(DNS)，互联网上的设备通过IP地址标识，全数子组成的标识不利于人类记忆和处理，域名的出现改变了这种状况，那么域名是如何对应的IP地址的呢，域名服务器（DNS服务器）就是来完成域名和IP地址的互相转换功能。DNS工作原理与ARP类似，区别是DNS通过指定的DNS服务器来查询，DNS服务器一般是安全的（实际上电信运营商等某些权威机构也经常耍流氓），问题是当明文的DNS数据包通过不安全的局域网时，会被篡改。</p></li></ul><h3 id="网络安全分类"><a href="#网络安全分类" class="headerlink" title="网络安全分类"></a>网络安全分类</h3><p>网络数据安全或许可分为两层：数据安全和链路安全。</p><ul><li><p>局域网数据安全，数据安全理解为数据包如果被别人获取，包含内容是否可被查看到，没有加密而明文传输的数据包都是非安全的。如SSl/STL协议数据包是安全的，而HTTP数据包一般是非安全的。数据包与协议实现有关，与网络拓扑结构无关。</p></li><li><p>局域网链路安全(PATH)，链路即网络数据包经过路线。如果正常通信过程中数据包有被非授权访问的可能，则认为该网络数据链路是不安全情况，因为数据包有被像嗅探甚至篡改的可能。交换型局域网正常情况是链路安全的（网关欺骗则是非正常情况）；共享式组网的局域网默认下就是链路不安全，该情况下数据包按广播方式发送，同网段内任一节点都可以收到包。</p></li></ul><p>###安全形势到底有多严重<br>广域网可以看作是一个大局域网（如大中国局域网），其组织结构与局域网有类似，但也不同，广域网构建在IP协议之上，因此它的安全性相对更好(除非你是电信内部人士，可以通过控制骨干网关键网络设备，代表如上海有线通用户经常被运营商网页弹窗骚扰；或者你有特殊权限可以直接接触到国家骨干网设备，这些控制权普通用户一般很难获得。)，而局域网中因为ARP协议的缺陷（不仅是ARP，应该是整套机制），导致局域网中很容易实现对网络流量的操控，局域网中典型的攻击模式大概是这样：</p><ol><li>第一步先攻击安全链路以获得数据包访问权，如通过ARP欺骗或者DNS欺骗方式改变正常数据包传输链路；</li><li>第二步数据包协议分析，使用抓包软件抓取和分析数据包内容，通过数据包篡改等多种手段最终达成攻击目的。(A)</li></ol><p>现实中贵重物品保存，一会放入保险箱（内容加密），二放在隐蔽的位置（链路隐藏），这样小偷一来发现不了，二来即使发现保险箱没有密码也无法打开，故这种方式相对安全。而这该死的局域网内，你的数据包一内容没有加密，二位置也没有隐藏，何来安全呢？</p><p>不消说掌握高超技术的大牛，就是仅会简单使用几个黑客工具的小菜鸟哥，都能在出租房内盗取几个MM的QQ空间帐号密码什么的。</p><p>局域网通信模型图示:</p><h2 id="几种常用黑客工具"><a href="#几种常用黑客工具" class="headerlink" title="几种常用黑客工具"></a>几种常用黑客工具</h2><p>工与善其事，必先利其器。</p><h3 id="Wireshark-抓包利器"><a href="#Wireshark-抓包利器" class="headerlink" title="Wireshark(抓包利器)"></a>Wireshark(抓包利器)</h3><p><a href="http://www.wireshark.org/" target="_blank" rel="noopener">Wireshark</a>（前称Ethereal）是一个网络封包分析软件。网络封包分析软件的功能是撷取网络封包，并尽可能显示出最为详细的网络封包资料。Windows下通过<a href="http://www.wireshark.org/download.html" target="_blank" rel="noopener">Download</a>页面下载安装即可，一般主流Linux发行版官方软件仓库已经集成该软件，可直接安装：</p><pre><code>$ sudo apt-get install wireshark       #Ubuntu$ sudo yum install wireshark           #Fedora/Redhat</code></pre><p>默认wireshark运行需要root权限，忽略警告信息，选择对应的网络节点开始抓包，wireshark提供两种数据包过滤机制：</p><ul><li><p>抓取时过滤规则，即不符合规则的包直接PASS不会抓取；详细规则使用参考<a href="http://wiki.wireshark.org/CaptureFilters" target="_blank" rel="noopener">CaptureFilters</a>,下面规则的作用是仅显示由192.168.1.100发出或者发往192.168.1.100的http数据包。<br>  host 192.168.1.100 and port 80</p></li><li><p>显示时过滤规则，即所有通过指定节点的包都抓取，但仅在界面上显示符合规则的包，详细规则使用参考<a href="http://wiki.wireshark.org/DisplayFilters" target="_blank" rel="noopener">DisplayFilters</a>，下面规则的作用是仅显示由192.168.1.100发出或者发往192.168.1.100的http数据包。<br>(http and ip.dst==192.168.1.100 ) or ( http and ip.src==192.168.1.100)</p></li></ul><h3 id="Nmap（网络探测工具和安全-端口扫描器）"><a href="#Nmap（网络探测工具和安全-端口扫描器）" class="headerlink" title="Nmap（网络探测工具和安全/端口扫描器）"></a>Nmap（网络探测工具和安全/端口扫描器）</h3><p><a href="http://nmap.org/man/zh/" target="_blank" rel="noopener">Nmap</a>,Linux平台下历史悠久且功能强大的网络探测工具和安全扫描器，支持扫描指定网络内主机列表、扫描指定主机开放端口列表甚至探测出所安装操作系统类型。该工具系统默认集成（支持在线包管理器直接安装）。</p><h3 id="Arpspoof-ARP欺骗）"><a href="#Arpspoof-ARP欺骗）" class="headerlink" title="Arpspoof(ARP欺骗）"></a>Arpspoof(ARP欺骗）</h3><p>ARP欺骗工具，工作原理就是不断的向目标（攻击对象）发送ARP数据包，包内容为“我是XXX，请把发给XXX的数据包发给我”。安装方法：</p><pre><code>$ sudo apt-get install dsniff</code></pre><h3 id="Ettercap-数据包嗅探和篡改"><a href="#Ettercap-数据包嗅探和篡改" class="headerlink" title="Ettercap(数据包嗅探和篡改)"></a>Ettercap(数据包嗅探和篡改)</h3><p><a href="http://ettercap.github.io/ettercap/index.html" target="_blank" rel="noopener">Ettercap</a>，“中间人”攻击利器，ARP欺骗、DNS欺骗、数据包替换等等，十分强大，不可细说，详细使用方式参考手册（man ettercap)。</p><pre><code>$ sudo apt-get install ettercap-graphical</code></pre><p>ettercap实现ARP欺骗方式如下<br>    $ sudo ettercap -i eth0 -Tq -M arp:remote /目标IP/ /网关IP/</p><h3 id="Driftnet"><a href="#Driftnet" class="headerlink" title="Driftnet"></a>Driftnet</h3><p>抓取经过本机的网络数据包中的图片并显示，同时支持抓取和显示音频文件（来源man手册），安装：</p><pre><code>$ sudo apt-get install driftnet</code></pre><h2 id="局域网典型攻击演习"><a href="#局域网典型攻击演习" class="headerlink" title="局域网典型攻击演习"></a>局域网典型攻击演习</h2><p>本演习系统环境如下：</p><pre><code>$ lsb_release -aDistributor ID:    UbuntuDescription:    Ubuntu 12.10Release:    12.10Codename:    quantal</code></pre><h3 id="第1步：锁定目标"><a href="#第1步：锁定目标" class="headerlink" title="第1步：锁定目标"></a>第1步：锁定目标</h3><p>该步不是必需。使用nmap命令扫描局域网，获得主机列表，操作如下：</p><pre><code>$ nmap -sP  192.168.1.0/24</code></pre><ul><li>“-sP” 表示使用Ping方式扫描；</li><li>“192.168.1.0/24”表示扫描”192.168.1.1-192.168.1.254”这个网段的所有机器。</li></ul><p>nmap命令扫描结果仅供参考，也可以尝试其他参数扫描，详细使用方法参考<a href="http://nmap.org/man/zh/" target="_blank" rel="noopener">NmapManual</a>。</p><h3 id="第2步：收集信息"><a href="#第2步：收集信息" class="headerlink" title="第2步：收集信息"></a>第2步：收集信息</h3><p>该步不是必需。选定目标为主机A(这里假定IP地址为192.168.1.110)，使用命令”nmap 192.168.1.110”可获得主机A的详细情况，如服务端口开放情况，操作系统类型等信息。</p><pre><code>$ nmap -A 192.168.1.110Starting Nmap 6.00 ( http://nmap.org ) at 2013-08-12 12:34 CST Nmap scan report for 10.3.3.108Host is up (0.00026s latency).Not shown: 996 closed portsPORT    STATE SERVICE     VERSION22/tcp  open  ssh         OpenSSH 5.9p1 Debian 5ubuntu1.1 (protocol 2.0)...139/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)445/tcp open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)873/tcp open  rsync       (protocol version 30) Service Info: OS: Linux; CPE: cpe:/o:linux:kernel</code></pre><h3 id="第3步：开启IP转发和ARP欺骗"><a href="#第3步：开启IP转发和ARP欺骗" class="headerlink" title="第3步：开启IP转发和ARP欺骗"></a>第3步：开启IP转发和ARP欺骗</h3><p>该步仅针对交换式局域网，共享式局域网可以忽略（共享式网络只要打开网卡的混杂模式就可以抓取所有内网数据包），ARP欺骗一般目的是把自己伪装成网关，但如果不作处理，当被欺骗数据包到达后就会被本机丢弃（因为自己到底不是网关，还不知道如何处理这类数据包），这当然是不允许的。开启IP转发功能可以解决该问题，IP转发负责把该类数据包再转发给真正的网关处理，开启IP转发的方法(注意使用root操作第二条命令）：</p><pre><code>$ sudo su# echo 1 &gt; /proc/sys/net/ipv4/ip_forward</code></pre><p>ARP欺骗使用arpspoof命令（开启双向欺骗，即同时欺骗主机A和网关）：</p><pre><code>$ sudo arpspoof -i eth0 -t 192.168.1.110 192.168.1.1$ sudo arpspoof -i eth0 -t 192.168.1.1 192.168.1.110</code></pre><ul><li>“-i eth0”指定设备节点，无线网络时可能是”-i wlan0”；</li><li>“-t 192.168.1.xxx”指定欺骗对象，如果不指定该项，则欺骗对象为整个网络（ARP病毒引起局域网瘫痪就是这么干的，操作前需注意)，最后一个参数”192.168.1.xxx”指伪装目标。</li></ul><p>上面第一条命令告诉主机A(192.168.1.110)，我是网关(192.168.1.1)，第二条命令告诉网关，我是主机A，故完成双向欺骗。</p><h3 id="第4步：抓数据包"><a href="#第4步：抓数据包" class="headerlink" title="第4步：抓数据包"></a>第4步：抓数据包</h3><p>该步不是必需。抓包分析只是为了辅助需要（通过分析数据包流量情况监控攻击工程，同时也是深入理解攻击原理的有效方法），使用wireshark工具抓取所有和主机A相关的数据包，过滤掉不相关数据包，只抓取主机A发出或者发给主机A的数据包。启动wireshark:</p><pre><code>$ sudo wireshark</code></pre><p>选择对应网络设备节点（一般有线网络选择eth0,无线网络选择wlan0)，开始抓包，在Filter输入框输入显示过滤条件：</p><pre><code>ip.addr == 192.168.1.110</code></pre><p>回车后应该在屏幕上看到已抓取包的列表，现在你可以仍然调取和分析主机A上网流量情况。</p><h3 id="第5步：收获果实"><a href="#第5步：收获果实" class="headerlink" title="第5步：收获果实"></a>第5步：收获果实</h3><p>抓取主机A http流量中的图片，通过driftnet工具实现，运行下面命令：</p><pre><code>$ sudo driftnet -i eth0</code></pre><p>篡改主机A访问的页面，通过ettercap工具实现，ettercap是个强大的工具，再配合sslstrip，基本可以为所欲为。<br>ettercap详细使用方法请参考man手册（man ettercap)，这里有一篇<a href="http://www.2cto.com/article/201301/183322.html" title="Ettercap简要原理介绍以及使用说明" target="_blank" rel="noopener">文章</a>可以参考一二。</p><p>##该如何防范<br>安全形势如此严重，不得不防啊。但安全总是有成本和代价的，下面建议供参考。</p><p><br><br>对于交换式局域网，重点守住两条：</p><ol><li>交换机端口绑定IP和MAC，完成该步，可以说基本天下太平，这个一般是网络管理员的职责；</li><li>如果第1步无法实现，在自己的机器上把网关IP和MAC地址静态绑定。</li></ol><p><br><br>对于共享式局域网,这一般是在家里、街上或者出租房中合伙使用的无线路由器下的网络。也是重点守着两条：</p><ol><li>不要随便连接未知无线网络；</li><li>管理好自己家里的无线路由器，最好使用WPA加密方式，并定期检察安全情况。</li></ol><p>##参考资料<br><a href="http://www.91ri.org/4408.html" title="Linux渗透之Ettercap详解" target="_blank" rel="noopener">Linux渗透之Ettercap详解</a> (较详细的ettercap文档翻译说明)<br><a href="http://www.2cto.com/article/201301/183322.html" title="Ettercap简要原理介绍以及使用说明" target="_blank" rel="noopener">Ettercap简要原理介绍以及使用说明</a> (Ettercap功能介绍)<br><a href="http://vmeng.blog.51cto.com/2305370/1143426" title="用ettercap实现DNS欺骗实例" target="_blank" rel="noopener">用ettercap实现DNS欺骗实例</a><br><a href="http://netsecurity.51cto.com/art/201212/371895.htm" title="不知不觉帐号密码被窃:中间人攻击介绍" target="_blank" rel="noopener">不知不觉帐号密码被窃:中间人攻击介绍</a><br><a href="http://blog.sina.com.cn/s/blog_4a898cfb0100t8j7.html" title="通过伪造CA证书，实现SSL中间人攻击(附详细过程和实现代码）" target="_blank" rel="noopener">通过伪造CA证书，实现SSL中间人攻击(附详细过程和实现代码）</a><br><a href="http://www.rootoorotor.org/hacking/%E5%85%B3%E4%BA%8Earp%E6%AC%BA%E9%AA%97%E4%B8%8Emitm%EF%BC%88%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%EF%BC%89%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" title="关于ARP欺骗与MITM（中间人攻击）的一些笔记（二）" target="_blank" rel="noopener">关于ARP欺骗与MITM（中间人攻击）的一些笔记（二）</a></p>]]></content>
    
    <summary type="html">
    
      当你在公司、在家里抑或咖啡馆连上了一个免费AP，享受互联网冲浪无比畅快的同时，背后可能正有双眼睛在监视着，MM们正在臭美的QQ空间，GG们正浏览的&quot;照片&quot;，甚至是银行卡等帐号信息...这到底是怎么回事？
    
    </summary>
    
      <category term="tech" scheme="http://goodbai.com/categories/tech/"/>
    
    
      <category term="安全" scheme="http://goodbai.com/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="Linux" scheme="http://goodbai.com/tags/Linux/"/>
    
  </entry>
  
</feed>
